# Functional Specification Design (FSD)
## zhr_r_it0267
### One Time Payment

**Generated on:** 2025-07-27 23:35:41

## 1. INFORMASI DOKUMEN

- **Project**: System Integrator for Management Information System Towards Single Source of Truth Implementation Program
- **Document Location**: zhr_r_it0267_20250727_233427.html

- **Related Documents**:
  - RICEFW ID: ZPQ_IT0267

- **Reviewers**:
  - Functional Lead: Nasya Miranda Umar

- **Version History**:
  - 0.01: Initial draft by Adfriansyah on 25.06.2025

## 2. PERSYARATAN UMUM

**User Requirements**: Terdapat kebutuhan untuk mengekstrak data infotype 0267 yang diinput secara manual oleh user, di-upload oleh user maupun hasil interface ke dalam satu template laporan.

One Time Payment (ZPQ_IT0267)

**Assumptions**:

## 3. EXISTING SAP OBJECTS

- **Program Name**: ZPQ_IT0267
- **Transaction Code**: zhr_r_it0267
- **Menu Path**: N/A

## 4. DESAIN

### 4.1 Description detail dari Report

Program ZHR_R_IT0267 menampilkan data One Time Payment dari infotype 0267.  Program membaca data dari infotype 0001 (data karyawan), 0032 (Payroll Area), dan 0267 (One Time Payment) berdasarkan periode payroll yang dihitung secara dinamis atau diinput melalui parameter seleksi.  Data master seperti Company Code (T001), Business Area (TGSBT), Wage Type (T512T), dan Reason Off-Cycle Payroll (T52OCRT) dibaca dan di-mapping ke data infotype. Output ditampilkan dalam ALV Grid dengan fungsi agregasi untuk kolom 'Count' dan 'Wage Type Amount'.  Terdapat validasi data berdasarkan parameter seleksi Wage Type, Reason, dan Off-cycle payroll date.  Program menggunakan kelas lokal `lcl_class` untuk enkapsulasi logika program.

### 4.2 Selection Screen

| Parameter | Type | Description | Mandatory | Select-Option | No Intervals |
|-----------|------|-------------|-----------|---------------|--------------|
| p_ocrsn | t52ocrt-ocrsn | Reason for payroll | No | No | No |
| p_begda | pa0267-begda | Off-cycle payroll | No | No | No |
| s_lgart | t512t-lgart | Wage Type | No | Yes | Yes |

### 4.3 Detail Processing

| Field Name | Technical Field | Source Table | Processing Logic | Processing Type |
|------------|-----------------|--------------|------------------|-----------------|
| Company Code | bukrs | PA0001 | Directly assigned from PA0001-bukrs. | DIRECT |
| Company Code Name | butxt | T001 | Fetched from T001 based on bukrs using a READ statement with a binary search. | LOOKUP |
| Business Area | gsber | PA0001 | Directly assigned from PA0001-gsber. | DIRECT |
| Business Area Text | gtext | TGSBT | Fetched from TGSBT based on gsber using a READ statement with a binary search. | LOOKUP |
| Count | count | None | Constant value of 1 is assigned. | CONSTANT |
| Personnel Number | pernr | PA0267 | Directly assigned from PA0267-pernr. | DIRECT |
| Previous Personnel Number | pnalt | PA0032 | Directly assigned from PA0032-pnalt. | DIRECT |
| Employee Name | ename | PA0001 | Directly assigned from PA0001-ename. | DIRECT |
| Start Date | begda | PA0267 | Directly assigned from PA0267-begda. | DIRECT |
| Wage Type | lgart | PA0267 | Directly assigned from PA0267-lgart. | DIRECT |
| Wage Type Text | lgtxt | T512T | Fetched from T512T based on lgart using a READ statement with a binary search. | LOOKUP |
| Wage Type Amount for Payments | betrg | PA0267 | Directly assigned from PA0267-betrg. | DIRECT |
| Currency | waers | PA0267 | Directly assigned from PA0267-waers. | DIRECT |
| Reason for Payroll | ocrsn | PA0267 | Directly assigned from PA0267-ocrsn. | DIRECT |
| Reason for Payroll Text | ocrtx | T52OCRT | Fetched from T52OCRT based on ocrsn using a READ statement with a binary search. | LOOKUP |

### 4.4 Detail Process Only valid datasets

| Data | Kondisi |
|------|---------|
| P0001 | Data P0001 dibaca untuk semua karyawan yang memiliki data di infotype 0267 (One Time Payment) dalam periode yang ditentukan. Tidak ada validasi eksplisit untuk infotype 0001 selain memastikan periodenya valid. |
| P0032 | Data P0032 dibaca untuk semua karyawan yang memiliki data di infotype 0267 dalam periode yang ditentukan. Tidak ada validasi eksplisit untuk infotype 0032 selain memastikan periodenya valid. |
| P0267 | Data P0267 difilter berdasarkan parameter selection screen:
- s_lgart: Jika diisi, hanya data dengan lgart (wage type) yang sesuai yang diambil.
- p_ocrsn: Jika diisi, hanya data dengan ocrsn (reason for payroll) yang sesuai yang diambil.
- p_begda: Jika diisi, hanya data dengan begda (begin date) setelah p_begda yang diambil. |

### Form Get_Country_Info

| Data | Kondisi |
|------|---------|
| BUTXT | Ambil BUTXT dari tabel T001 dengan key BUKRS = p0001-bukrs. Jika sy-subrc = 0, isi field butxt dengan hasil lookup. |

### Form Get_Currency_T500C

| Data | Kondisi |
|------|---------|
| GTEXT | Ambil GTEXT dari tabel TGSBT dengan key GSBER = p0001-gsber. Jika sy-subrc = 0, isi field gtext dengan hasil lookup. |

### Form Get_Currency_T001

| Data | Kondisi |
|------|---------|
| LGTXT | Ambil LGTXT dari tabel T512T dengan key LGART = p0267-lgart. Jika sy-subrc = 0, isi field lgtxt dengan hasil lookup. |
| OCRTX | Ambil OCRTX dari tabel T52OCRT dengan key OCRSN = p0267-ocrsn. Jika sy-subrc = 0, isi field ocrtx dengan hasil lookup. |

## 5. PENANGANAN ERROR

| No | Error Description | Resolution | Error Code | Severity |
|----|-------------------|------------|------------|----------|
| 1 | Tanggal input pada parameter p_begda bukan tanggal yang valid. | Pastikan format tanggal pada parameter p_begda valid (YYYYMMDD). | day_in_no_date | ERROR |
| 2 | Error tidak terdefinisi saat menentukan tanggal akhir bulan. | Periksa kembali log dan variabel yang terkait dengan fungsi 'RP_LAST_DAY_OF_MONTHS' untuk menentukan penyebab error. | OTHERS | ERROR |
| 3 | Proses RHR018_01 sedang aktif. | Tunggu hingga proses RHR018_01 selesai atau hubungi administrator. | e017 | ERROR |
| 4 | Tabel gt_report kosong, tidak ada data yang ditampilkan. | Periksa kriteria seleksi dan data yang ada pada infotype 0267, 0001, dan 0032. Pastikan data yang dibutuhkan tersedia. | TEXT-m01 | ERROR |

## 6. PERSYARATAN PENGUJIAN

| No | Test Condition | Expected Result | Test Data | Priority |
|----|----------------|-----------------|-----------|----------|
| 1 | Pengujian dengan input data yang valid dan lengkap. | Laporan ALV ditampilkan dengan data sesuai kriteria seleksi. | {'p_ocrsn': 'A', 'p_begda': '20230101', 's_lgart-low': '1000', 's_lgart-high': ''} | HIGH |
| 2 | Pengujian dengan parameter p_ocrsn kosong. | Laporan ALV ditampilkan dengan data tanpa filter p_ocrsn. | {'p_ocrsn': '', 'p_begda': '20230101', 's_lgart-low': '1000', 's_lgart-high': ''} | MEDIUM |
| 3 | Pengujian dengan parameter p_begda kosong. | Laporan ALV ditampilkan dengan data tanpa filter p_begda. | {'p_ocrsn': 'A', 'p_begda': '', 's_lgart-low': '1000', 's_lgart-high': ''} | MEDIUM |
| 4 | Pengujian dengan select-option s_lgart kosong. | Laporan ALV ditampilkan dengan data tanpa filter s_lgart. | {'p_ocrsn': 'A', 'p_begda': '20230101', 's_lgart-low': '', 's_lgart-high': ''} | MEDIUM |
| 5 | Pengujian dengan semua parameter seleksi kosong. | Laporan ALV ditampilkan dengan semua data dari infotype 0267 sesuai rentang tanggal yang dihitung. | {'p_ocrsn': '', 'p_begda': '', 's_lgart-low': '', 's_lgart-high': ''} | MEDIUM |
| 6 | Pengujian dengan input data yang tidak valid pada p_ocrsn. | Laporan ALV ditampilkan kosong karena tidak ada data yang sesuai. | {'p_ocrsn': 'Z', 'p_begda': '20230101', 's_lgart-low': '1000', 's_lgart-high': ''} | HIGH |
| 7 | Pengujian dengan input data yang tidak valid pada s_lgart. | Laporan ALV ditampilkan kosong karena tidak ada data yang sesuai. | {'p_ocrsn': 'A', 'p_begda': '20230101', 's_lgart-low': '9999', 's_lgart-high': ''} | HIGH |
| 8 | Pengujian dengan input data p_begda lebih besar dari tanggal terkini pada infotype 0267. | Laporan ALV ditampilkan kosong karena tidak ada data yang sesuai. | {'p_ocrsn': 'A', 'p_begda': '99991231', 's_lgart-low': '1000', 's_lgart-high': ''} | HIGH |
| 9 | Pengujian performa dengan data yang banyak (lebih dari 1000 record). | Laporan ALV ditampilkan dengan waktu yang wajar (misalnya, kurang dari 10 detik). | {'p_ocrsn': '', 'p_begda': '', 's_lgart-low': '', 's_lgart-high': ''} | HIGH |