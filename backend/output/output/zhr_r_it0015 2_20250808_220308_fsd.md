# Functional Specification Design (FSD)
## ZHR_R_IT0015
### Additional Payment & deduction

**Generated on:** 2025-08-08 22:04:26

## 1. INFORMASI DOKUMEN

- **Project**: System Integrator for Management Information System (MIS) Towards Single Source of Truth (SSoT)
- **Document Location**: zhr_r_it0015 2_20250808_220308.html

- **Related Documents**:
  - RICEFW ID: RHR018
  - RICEFW ID: RHR006

- **Reviewers**:
  - Functional Lead: Nasya Miranda Umar
  - Functional Lead: Nasya Miranda Umar

- **Version History**:
  - 0.01: Initial draft by Adfriansyah on 25.06.2025
  - 0.01: Initial draft by ICON_RIO (Rio R) on 25.06.2025

## 2. PERSYARATAN UMUM

**User Requirements**: Pengguna membutuhkan laporan untuk menampilkan data tambahan pembayaran dan potongan tidak tetap karyawan. Laporan ini harus menampilkan informasi seperti kode perusahaan, area bisnis, nama karyawan, tanggal mulai, jenis upah, jumlah, dan mata uang.

**Assumptions**:
- Infotype 0015 (Additional Payment) telah dibuat.
- Pengguna memiliki otorisasi untuk menjalankan program.

## 3. EXISTING SAP OBJECTS

- **Program Name**: ZHR_R_IT0015
- **Transaction Code**: ZHR_R_IT0015
- **Menu Path**: N/A

## 4. DESAIN

### 4.1 Description detail dari Report

Program ZHR_R_IT0015 menampilkan data tambahan pembayaran dan potongan tidak tetap dari infotype 0015. Program ini membaca data dari beberapa infotype (0000, 0001, 0014, 0015, dan 0032) dan tabel master (T001, TGSBT, T512T).  Program ini menggunakan kelas `lcl_class` untuk memproses data.  Berikut alur kerja program:
1. **Seleksi**: Pengguna dapat memilih jenis upah (lgart) melalui `select-options s_lgart`.
2. **Inisiasi**: Program menginisiasi periode evaluasi payroll.
3. **At Selection-Screen**: Program memeriksa apakah proses sedang aktif dan otorisasi pengguna.
4. **Start-of-Selection**: Program membuat instance dari kelas  `lcl_class` dan memanggil beberapa method:
    - `get_populate_range_date`: Menentukan rentang tanggal awal dan akhir bulan berdasarkan input pengguna.
    - `get_additional_data`: Membaca data dari T001, TGSBT, dan T512T.
    - `get_data`: Membaca data infotype 0001, 0015, dan 0032, lalu menggabungkannya dengan data dari tabel master.
5. **End-of-Selection**: Program memanggil method berikut:
    - `process_data`: Memfilter data berdasarkan seleksi pengguna.
    - `display_alv`: Menampilkan data dalam ALV Grid.
Output program berupa ALV Grid yang menampilkan data gabungan dari infotype 0001, 0015, 0032, T001, TGSBT, dan T512T, difilter berdasarkan jenis upah yang dipilih pengguna.

### 4.2 Selection Screen

| Parameter | Type | Description | Mandatory | Select-Option | No Intervals |
|-----------|------|-------------|-----------|---------------|--------------|
| p_ocrsn | t52ocrt-ocrsn | Reason for payroll | No | No | No |
| p_begda | pa0267-begda | Off-cycle payroll | No | No | No |
| s_lgart | t512t-lgart | Wage Type | No | Yes | Yes |
| s_lgart | p0015-lgart | Wage Type | No | Yes | Yes |

### 4.3 Detail Processing

| Field Name | Technical Field | Source Table | Processing Logic | Processing Type |
|------------|-----------------|--------------|------------------|-----------------|
| Company Code | bukrs | PA0001 | Diambil langsung dari infotype 0001 (PA0001-bukrs). | DIRECT |
| Company Code Name | butxt | T001 | Di-lookup dari tabel T001 berdasarkan lw_report-bukrs. | LOOKUP |
| Business Area | gsber | PA0001 | Diambil langsung dari infotype 0001 (PA0001-gsber). | DIRECT |
| Business Area Text | gtext | TGSBT | Di-lookup dari tabel TGSBT berdasarkan lw_report-gsber. | LOOKUP |
| Count | count | None | Diisi dengan konstanta 1 untuk setiap record di PA0267. | CONSTANT |
| Personnel Number | pernr | PA0267 | Diambil langsung dari infotype 0267 (PA0267-pernr). | DIRECT |
| Previous Personnel Number | pnalt | PA0032 | Diambil langsung dari infotype 0032 (PA0032-pnalt). | DIRECT |
| Employee Name | ename | PA0001 | Diambil langsung dari infotype 0001 (PA0001-ename). | DIRECT |
| Start Date | begda | PA0267 | Diambil langsung dari infotype 0267 (PA0267-begda). | DIRECT |
| Wage Type | lgart | PA0267 | Diambil langsung dari infotype 0267 (PA0267-lgart). | DIRECT |
| Wage Type Text | lgtxt | T512T | Di-lookup dari tabel T512T berdasarkan lw_report-lgart. | LOOKUP |
| Wage Type Amount for Payments | betrg | PA0267 | Diambil langsung dari infotype 0267 (PA0267-betrg). | DIRECT |
| Currency | waers | PA0267 | Diambil langsung dari infotype 0267 (PA0267-waers). | DIRECT |
| Reason for Payroll | ocrsn | PA0267 | Diambil langsung dari infotype 0267 (PA0267-ocrsn). | DIRECT |
| Reason for Payroll Text | ocrtx | T52OCRT | Di-lookup dari tabel T52OCRT berdasarkan lw_report-ocrsn. | LOOKUP |
| Company Code | bukrs | P0001 | Directly assigned from P0001-bukrs. | DIRECT |
| Name of Company Code | butxt | T001 | Fetched from T001-butxt using a READ statement with P0001-bukrs as the key. | LOOKUP |
| Business Area | gsber | P0001 | Directly assigned from P0001-gsber. | DIRECT |
| Business Area Description | gsber_text | TGSBT | Fetched from TGSBT-gtext using a READ statement with P0001-gsber as the key. | LOOKUP |
| Count | count | None | A counter variable (lv_no), incremented for each record. | CALCULATION |
| Personnel Number | pernr | P0001 | Directly assigned from P0001-pernr. | DIRECT |
| No Induk Pegawai | prev_pernr | P0032 | Directly assigned from P0032-pnalt. | DIRECT |
| Name of Employee or applicant | name | P0001 | Directly assigned from P0001-ename. | DIRECT |
| Start Date | begda | P0015 | Directly assigned from P0015-begda. | DIRECT |
| Wage Type | lgart | P0015 | Directly assigned from P0015-lgart. | DIRECT |
| Wage Type | lgtxt | T512T | Fetched from T512T-lgtxt using a READ statement with P0015-lgart as the key. | LOOKUP |
| Amount | betrg | P0015 | Directly assigned from P0015-betrg. | DIRECT |
| Currency | waers | P0015 | Directly assigned from P0015-waers. | DIRECT |

### 4.4 Detail Process Only valid datasets

| Data | Kondisi |
|------|---------|
| P0001 | Data Infotype 0001 dibaca untuk setiap karyawan (PERNR) yang ada pada tabel PERAS. Pembacaan dilakukan berdasarkan periode yang ditentukan oleh  `gv_begda` dan `gv_endda`.  Tidak ada validasi eksplisit pada data P0001 selain memastikan data tersebut ada dalam rentang periode yang ditentukan. |
| P0032 | Data Infotype 0032 dibaca untuk setiap karyawan (PERNR) yang ada pada tabel PERAS. Pembacaan dilakukan berdasarkan periode yang ditentukan oleh `gv_begda` dan `gv_endda`. Tidak ada validasi eksplisit pada data P0032 selain memastikan data tersebut ada dalam rentang periode yang ditentukan. |
| P0267 | Data Infotype 0267 dibaca untuk setiap karyawan (PERNR) yang ada pada tabel PERAS. Pembacaan dilakukan berdasarkan periode yang ditentukan oleh `gv_begda` dan `gv_endda`. Data P0267 difilter berdasarkan parameter seleksi `s_lgart` (Wage Type), `p_ocrsn` (Reason for Off-Cycle Payroll), dan `p_begda` (Off-Cycle Payroll Date) yang diinputkan oleh pengguna.  Data yang tidak memenuhi kriteria seleksi akan dihapus dari tabel internal `gt_report`. |
| gt_report | Tabel internal `gt_report` berisi data yang diambil dari Infotype 0001, 0032, dan 0267. Data dalam tabel ini dianggap valid jika memenuhi semua kondisi validasi yang diterapkan pada P0267, yaitu filter berdasarkan `s_lgart`, `p_ocrsn`, dan `p_begda`. |
| P0000 | Tidak ada kondisi validasi spesifik untuk infotype 0000 selain pembacaan data. |
| P0001 | Tidak ada kondisi validasi spesifik untuk infotype 0001 selain pembacaan data. Data P0001 digunakan untuk mendapatkan beberapa field seperti bukrs, gsber, dan ename. |
| P0014 | Tidak ada kondisi validasi spesifik untuk infotype 0014 selain pembacaan data. Data ini tidak digunakan dalam program. |
| P0015 | Data P0015 difilter berdasarkan wage type (lgart) yang dipilih di selection screen (s_lgart).  Data P0015 juga divalidasi dengan memastikan pernr tidak initial. Jika kosong, data tidak akan diproses lebih lanjut. |
| P0032 | Tidak ada kondisi validasi spesifik untuk infotype 0032 selain pembacaan data. Data P0032 digunakan untuk mengambil Previous Personnel Number (pnalt). |

### Form Get_Country_Info

| Data | Kondisi |
|------|---------|
| BUTXT | Ambil BUTXT dari tabel T001 dengan key BUKRS = p0001-bukrs. Jika sy-subrc = 0, isi field butxt dengan hasil lookup. |
| BUTXT | Ambil BUTXT dari tabel T001 dengan key BUKRS = P0001-BUKRS. Jika sy-subrc = 0, isi field butxt dengan hasil lookup. |

### Form Get_Currency_T500C

| Data | Kondisi |
|------|---------|
| GTEXT | Ambil GTEXT dari tabel TGSBT dengan key GSBER = p0001-gsber. Jika sy-subrc = 0, isi field gtext dengan hasil lookup. |
| GTEXT | Ambil GTEXT dari tabel TGSBT dengan key GSBER = P0001-GSBER. Jika sy-subrc = 0, isi field gsber_text dengan hasil lookup. |

### Form Get_Currency_T001

| Data | Kondisi |
|------|---------|
| LGTXT | Ambil LGTXT dari tabel T512T dengan key LGART = p0267-lgart. Jika sy-subrc = 0, isi field lgtxt dengan hasil lookup. |
| OCRTX | Ambil OCRTX dari tabel T52OCRT dengan key OCRSN = p0267-ocrsn. Jika sy-subrc = 0, isi field ocrtx dengan hasil lookup. |
| LGTXT | Ambil LGTXT dari tabel T512T dengan key LGART = P0015-LGART. Jika sy-subrc = 0, isi field lgtxt dengan hasil lookup. |

## 5. PENANGANAN ERROR

| No | Error Description | Resolution | Error Code | Severity |
|----|-------------------|------------|------------|----------|
| 1 | Tanggal input pada parameter p_begda tidak valid. | Pastikan format tanggal pada parameter p_begda valid (YYYYMMDD). | day_in_no_date | ERROR |
| 2 | Error tidak terdefinisi saat memanggil function 'RP_LAST_DAY_OF_MONTHS'. | Periksa kembali input parameter pada function 'RP_LAST_DAY_OF_MONTHS' dan dokumentasi function untuk informasi lebih lanjut. | OTHERS | ERROR |
| 3 | Proses RHR018_01 sedang aktif. | Tunggu hingga proses RHR018_01 selesai atau hubungi administrator. | e017 | ERROR |
| 4 | Tabel gt_report kosong setelah validasi. | Periksa kembali kriteria seleksi yang dimasukkan. Pastikan data yang sesuai dengan kriteria seleksi ada di database. | TEXT-m01 | ERROR |
| 5 | Kolom yang diminta tidak ditemukan saat mengatur teks kolom di ALV. | Periksa kembali nama kolom yang digunakan pada method f_display_alv. Pastikan nama kolom sesuai dengan struktur gt_report. | cx_salv_not_found | ERROR |
| 6 | Kesalahan data saat mengatur teks kolom di ALV. | Periksa tipe data kolom dan nilai yang akan di-set. Pastikan tipe data dan nilai kompatibel. | cx_salv_data_error | ERROR |
| 7 | Error saat membuat objek SALV. | Periksa kembali parameter yang diberikan ke method factory dan pastikan data yang diberikan valid. | cx_salv_msg | ERROR |
| 8 | Agregasi sudah ada saat mencoba menambahkan agregasi di ALV. | Periksa kembali nama agregasi yang digunakan. Pastikan nama agregasi belum ditambahkan sebelumnya. | cx_salv_existing | ERROR |
| 9 | Proses dengan ID RHR006_01 sedang aktif. | Tunggu hingga proses selesai atau hubungi administrator. | E017 | ERROR |
| 10 | User tidak memiliki otorisasi untuk menjalankan program ZPQ_IT0015. | Hubungi administrator untuk mendapatkan otorisasi yang dibutuhkan. | I172 | ERROR |
| 11 | Tanggal input tidak valid. | Periksa kembali tanggal yang diinput dan pastikan formatnya benar (YYYYMMDD). | Day_in_no_date | ERROR |
| 12 | Gagal mengambil nilai select-option ZP_SUPPORT_PAYROLL | Periksa konfigurasi TVarV ZP_SUPPORT_PAYROLL | None | INFO |

## 6. PERSYARATAN PENGUJIAN

| No | Test Condition | Expected Result | Test Data | Priority |
|----|----------------|-----------------|-----------|----------|
| 1 | Karyawan dengan data infotype 0267 yang lengkap dan sesuai dengan kriteria seleksi. | Data karyawan ditampilkan di ALV dengan informasi yang benar, meliputi kode perusahaan, nama perusahaan, area bisnis, deskripsi area bisnis, jenis upah, deskripsi jenis upah, jumlah upah, mata uang, alasan pembayaran off-cycle, dan deskripsi alasan pembayaran off-cycle. | pernr: 1000, lgart: 1000, betrg: 1000000, waers: IDR, ocrsn: 01, begda: 01.01.2024 | HIGH |
| 2 | Karyawan tanpa data infotype 0267. | Data karyawan tidak ditampilkan di ALV. | pernr: 2000 (tanpa data di infotype 0267) | HIGH |
| 3 | Input parameter s_lgart diisi. | Hanya data karyawan dengan lgart yang sesuai dengan input s_lgart yang ditampilkan. | s_lgart: 1000 | MEDIUM |
| 4 | Input parameter p_ocrsn diisi. | Hanya data karyawan dengan ocrsn yang sesuai dengan input p_ocrsn yang ditampilkan. | p_ocrsn: 01 | MEDIUM |
| 5 | Input parameter p_begda diisi. | Hanya data karyawan dengan begda setelah p_begda yang ditampilkan. | p_begda: 01.01.2024 | MEDIUM |
| 6 | Input parameter s_lgart, p_ocrsn, dan p_begda diisi. | Hanya data karyawan yang memenuhi ketiga kriteria tersebut yang ditampilkan. | s_lgart: 1000, p_ocrsn: 01, p_begda: 01.01.2024 | MEDIUM |
| 7 | Input parameter s_lgart diisi dengan nilai yang tidak ada di data. | Tidak ada data yang ditampilkan di ALV dan muncul pesan error TEXT-m01. | s_lgart: 9999 | MEDIUM |
| 8 | Input parameter p_ocrsn diisi dengan nilai yang tidak ada di data. | Tidak ada data yang ditampilkan di ALV dan muncul pesan error TEXT-m01. | p_ocrsn: 99 | MEDIUM |
| 9 | Input parameter p_begda diisi dengan tanggal yang lebih besar dari semua begda yang ada di data. | Tidak ada data yang ditampilkan di ALV dan muncul pesan error TEXT-m01. | p_begda: 01.01.2025 | MEDIUM |
| 10 | Data infotype 0001, 0032, atau 0267 tidak ada atau tidak lengkap. | Data yang tidak ada atau tidak lengkap akan diabaikan, dan hanya data yang valid yang ditampilkan di ALV.  Tidak ada pesan error yang muncul. | Karyawan dengan data tidak lengkap di salah satu infotype 0001, 0032, atau 0267. | LOW |
| 11 | Proses RHR018_01 tidak aktif. | Program menampilkan pesan error e017(zab) dan berhenti. | Nonaktifkan proses RHR018_01 | HIGH |
| 12 | Pengujian dengan data yang sangat banyak (misalnya, 10.000 record). | ALV ditampilkan dengan benar dan performanya wajar. | 10.000 record data karyawan | LOW |
| 13 | Pengujian otorisasi pengguna yang valid. | Program berjalan dan menampilkan data. | User yang terdaftar dalam parameter 'ZP_SUPPORT_PAYROLL'. | HIGH |
| 14 | Pengujian otorisasi pengguna yang tidak valid. | Program menampilkan pesan error dan berhenti. | User yang tidak terdaftar dalam parameter 'ZP_SUPPORT_PAYROLL'. | HIGH |
| 15 | Pengujian proses yang sedang berjalan. | Program menampilkan pesan error dan berhenti. | Jalankan report ini saat report dengan process id 'RHR006_01' sedang aktif. | HIGH |
| 16 | Pengujian dengan input selection option lgart terisi. | Program hanya menampilkan data dengan lgart yang sesuai dengan input selection option. | Masukkan satu atau beberapa wage type pada selection option s_lgart. | MEDIUM |
| 17 | Pengujian dengan input selection option lgart kosong. | Program menampilkan semua data tanpa filter lgart. | Biarkan selection option s_lgart kosong. | MEDIUM |
| 18 | Pengujian dengan data infotype 0015 kosong. | Tabel ALV ditampilkan kosong. | Data pernr pada infotype 0015 tidak ada. | MEDIUM |
| 19 | Pengujian dengan data infotype 0001, 0015, dan 0032 terisi. | Tabel ALV menampilkan data sesuai dengan infotype yang terisi. | Data pernr pada infotype 0001, 0015, dan 0032 terisi dengan data yang valid. | MEDIUM |
| 20 | Pengujian dengan data master T001, TGSBT, dan T512T kosong. | Tabel ALV ditampilkan dengan field BUTXT, GSBER_TEXT, dan LGTXT kosong. | Kosongkan data pada tabel T001, TGSBT, dan T512T. | LOW |
| 21 | Pengujian dengan bulan Januari. | Program menghitung gv_begda dan gv_endda dengan benar untuk bulan Januari. | pn-begda = '20230101'. | LOW |
| 22 | Pengujian dengan bulan Desember. | Program menghitung gv_begda dan gv_endda dengan benar untuk bulan Desember. | pn-begda = '20231201'. | LOW |
| 23 | Pengujian dengan jumlah data yang banyak (performance test). | Program berjalan dengan performa yang wajar. | Data infotype 0015 dengan jumlah data yang sangat banyak (misalnya, 1 juta record). | LOW |