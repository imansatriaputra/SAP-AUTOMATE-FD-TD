<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=ISO-8859-1" />
<title>ZHR_R_IT0267</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZHR_R_IT0267</h2>
<h3> Description: One Time Payment</h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="codeComment">
*-----------------------------------------------------------------------<br />
*&nbsp;Confidential&nbsp;and&nbsp;Proprietary<br />
*&nbsp;PLN&nbsp;ERP&nbsp;Single&nbsp;Source&nbsp;of&nbsp;Truth&nbsp;Project<br />
*----------------------------------------------------------------------*<br />
*&nbsp;Object&nbsp;Name&nbsp;:&nbsp;ZHR_R_IT0267<br />
*&nbsp;RICEFW&nbsp;ID&nbsp;&nbsp;&nbsp;:&nbsp;[RHR018]<br />
*&nbsp;Created&nbsp;on&nbsp;&nbsp;:&nbsp;25.06.2025<br />
*&nbsp;Created&nbsp;by&nbsp;&nbsp;:&nbsp;[ICON_ADFRI]&nbsp;(Adfriansyah)<br />
*&nbsp;Functional&nbsp;&nbsp;:&nbsp;(Nasya&nbsp;Miranda&nbsp;Umar)<br />
*&nbsp;Description&nbsp;:&nbsp;Report&nbsp;One&nbsp;Time&nbsp;Payment<br />
*&nbsp;Assumption&nbsp;&nbsp;:<br />
*----------------------------------------------------------------------<br />
*&nbsp;CHANGE&nbsp;ON&nbsp;&nbsp;&nbsp;CHANGE&nbsp;BY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGE&nbsp;NO<br />
*----------------------------------------------------------------------<br />
*&nbsp;25.06.2025&nbsp;&nbsp;[ICON_ADFRI]/(Adfriansyah)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[DR1K902355]<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[Initial&nbsp;Program]<br />
*----------------------------------------------------------------------<br />
   </div>
   <div class="code">
REPORT zhr_r_it0267.<br />
<br />
   </div>
   <div class="codeComment">
*-----------------------------------------------------------------------<br />
*&nbsp;N&nbsp;O&nbsp;D&nbsp;E&nbsp;S<br />
*-----------------------------------------------------------------------<br />
   </div>
   <div class="code">
NODES:<br />
&nbsp;&nbsp;peras.<br />
<br />
   </div>
   <div class="codeComment">
*----------------------------------------------------------------------*<br />
*&nbsp;T&nbsp;A&nbsp;B&nbsp;L&nbsp;E&nbsp;S<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
TABLES:<br />
&nbsp;&nbsp;pernr&nbsp;&nbsp;&nbsp;##NEEDED,&nbsp;"Standard&nbsp;Selections&nbsp;for&nbsp;HR&nbsp;Master&nbsp;Data&nbsp;Reporting<br />
&nbsp;&nbsp;t52ocrt&nbsp;##NEEDED,<br />
&nbsp;&nbsp;t512t&nbsp;&nbsp;&nbsp;##NEEDED.<br />
   </div>
   <div class="codeComment">
*----------------------------------------------------------------------*<br />
*&nbsp;T&nbsp;Y&nbsp;P&nbsp;E&nbsp;S<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
TYPE-POOLS:<br />
&nbsp;&nbsp;abap.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ABAP&nbsp;Language&nbsp;Type-Pool<br />
<br />
TYPES:<br />
&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;gty_report,<br />
&nbsp;&nbsp;&nbsp;&nbsp;bukrs&nbsp;TYPE&nbsp;pa0001-bukrs,<br />
&nbsp;&nbsp;&nbsp;&nbsp;butxt&nbsp;TYPE&nbsp;t001-butxt,<br />
&nbsp;&nbsp;&nbsp;&nbsp;gsber&nbsp;TYPE&nbsp;pa0001-gsber,<br />
&nbsp;&nbsp;&nbsp;&nbsp;gtext&nbsp;TYPE&nbsp;tgsbt-gtext,<br />
&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;TYPE&nbsp;i,<br />
&nbsp;&nbsp;&nbsp;&nbsp;pernr&nbsp;TYPE&nbsp;pa0001-pernr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;pnalt&nbsp;TYPE&nbsp;pa0032-pnalt,<br />
&nbsp;&nbsp;&nbsp;&nbsp;ename&nbsp;TYPE&nbsp;pa0001-ename,<br />
&nbsp;&nbsp;&nbsp;&nbsp;begda&nbsp;TYPE&nbsp;pa0267-begda,<br />
&nbsp;&nbsp;&nbsp;&nbsp;lgart&nbsp;TYPE&nbsp;pa0267-lgart,<br />
&nbsp;&nbsp;&nbsp;&nbsp;lgtxt&nbsp;TYPE&nbsp;t512t-lgtxt,<br />
&nbsp;&nbsp;&nbsp;&nbsp;betrg&nbsp;TYPE&nbsp;pa0267-betrg,<br />
&nbsp;&nbsp;&nbsp;&nbsp;waers&nbsp;TYPE&nbsp;pa0267-waers,<br />
&nbsp;&nbsp;&nbsp;&nbsp;ocrsn&nbsp;TYPE&nbsp;pa0267-ocrsn,<br />
&nbsp;&nbsp;&nbsp;&nbsp;ocrtx&nbsp;TYPE&nbsp;t52ocrt-ocrtx,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;gty_report,<br />
<br />
&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;gty_t001,<br />
&nbsp;&nbsp;&nbsp;&nbsp;bukrs&nbsp;TYPE&nbsp;t001-bukrs,<br />
&nbsp;&nbsp;&nbsp;&nbsp;butxt&nbsp;TYPE&nbsp;t001-butxt,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;gty_t001,<br />
<br />
&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;gty_tgsbt,<br />
&nbsp;&nbsp;&nbsp;&nbsp;gsber&nbsp;TYPE&nbsp;tgsbt-gsber,<br />
&nbsp;&nbsp;&nbsp;&nbsp;gtext&nbsp;TYPE&nbsp;tgsbt-gtext,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;gty_tgsbt,<br />
<br />
&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;gty_t512t,<br />
&nbsp;&nbsp;&nbsp;&nbsp;lgart&nbsp;TYPE&nbsp;t512t-lgart,<br />
&nbsp;&nbsp;&nbsp;&nbsp;lgtxt&nbsp;TYPE&nbsp;t512t-lgtxt,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;gty_t512t,<br />
<br />
&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;gty_t52ocrt,<br />
&nbsp;&nbsp;&nbsp;&nbsp;ocrsn&nbsp;TYPE&nbsp;t52ocrt-ocrsn,<br />
&nbsp;&nbsp;&nbsp;&nbsp;ocrtx&nbsp;TYPE&nbsp;t52ocrt-ocrtx,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;gty_t52ocrt,<br />
<br />
&nbsp;&nbsp;gtt_report&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;gty_report&nbsp;WITH&nbsp;EMPTY&nbsp;KEY,<br />
&nbsp;&nbsp;gtt_t001&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;gty_t001,<br />
&nbsp;&nbsp;gtt_tgsbt&nbsp;&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;gty_tgsbt,<br />
&nbsp;&nbsp;gtt_t512t&nbsp;&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;gty_t512t,<br />
&nbsp;&nbsp;gtt_t52ocrt&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;gty_t52ocrt.<br />
<br />
   </div>
   <div class="codeComment">
*----------------------------------------------------------------------*<br />
*&nbsp;I&nbsp;N&nbsp;T&nbsp;E&nbsp;R&nbsp;N&nbsp;A&nbsp;L&nbsp;&nbsp;&nbsp;T&nbsp;A&nbsp;B&nbsp;L&nbsp;E&nbsp;S&nbsp;&nbsp;&nbsp;&&nbsp;&nbsp;&nbsp;W&nbsp;O&nbsp;R&nbsp;K&nbsp;I&nbsp;N&nbsp;G&nbsp;-&nbsp;A&nbsp;R&nbsp;E&nbsp;A&nbsp;S<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
DATA: gt_report           TYPE gtt_report,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_t001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;gtt_t001,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_tgsbt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;gtt_tgsbt,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_t512t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;gtt_t512t,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_t52ocrt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;gtt_t52ocrt,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o_salv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cl_salv_table,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o_alv_columns_table&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cl_salv_columns_table.<br />
<br />
   </div>
   <div class="codeComment">
*----------------------------------------------------------------------*<br />
*&nbsp;I&nbsp;N&nbsp;F&nbsp;O&nbsp;T&nbsp;Y&nbsp;P&nbsp;E&nbsp;S<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
INFOTYPES : 0001 MODE N,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0032&nbsp;MODE&nbsp;N,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0267&nbsp;MODE&nbsp;N.<br />
<br />
   </div>
   <div class="codeComment">
*----------------------------------------------------------------------*<br />
*&nbsp;R&nbsp;A&nbsp;N&nbsp;G&nbsp;E&nbsp;S<br />
*----------------------------------------------------------------------*<br />
*DATA:<br />
<br />
*----------------------------------------------------------------------*<br />
*&nbsp;G&nbsp;L&nbsp;O&nbsp;B&nbsp;A&nbsp;L&nbsp;&nbsp;&nbsp;V&nbsp;A&nbsp;R&nbsp;I&nbsp;A&nbsp;B&nbsp;L&nbsp;E&nbsp;S<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
DATA:<br />
&nbsp;&nbsp;gv_begda&nbsp;TYPE&nbsp;sy-datum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##NEEDED,<br />
&nbsp;&nbsp;gv_endda&nbsp;TYPE&nbsp;sy-datum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##NEEDED.<br />
<br />
   </div>
   <div class="codeComment">
*----------------------------------------------------------------------*<br />
*&nbsp;C&nbsp;O&nbsp;N&nbsp;S&nbsp;T&nbsp;A&nbsp;N&nbsp;T&nbsp;S<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
CONSTANTS:<br />
&nbsp;&nbsp;gc_pcce_eval_period&nbsp;TYPE&nbsp;pcce_eval_period&nbsp;&nbsp;&nbsp;VALUE&nbsp;2,<br />
&nbsp;&nbsp;gc_date_01(2)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUE&nbsp;'01',<br />
&nbsp;&nbsp;gc_procid_01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;zab_db_proc-prcod&nbsp;&nbsp;VALUE&nbsp;'RHR018_01',&nbsp;##NEEDED&nbsp;&nbsp;"Summary&nbsp;Data&nbsp;Id<br />
&nbsp;&nbsp;gc_molga&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;molga&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUE&nbsp;'34'.<br />
<br />
   </div>
   <div class="codeComment">
*----------------------------------------------------------------------*<br />
*&nbsp;CLASS&nbsp;DEFINITION<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
CLASS lcl_class DEFINITION ##CLASS_FINAL.<br />
&nbsp;&nbsp;PUBLIC&nbsp;SECTION.<br />
&nbsp;&nbsp;&nbsp;&nbsp;METHODS:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_populate_range_date,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_get_dtl,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_get_data,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_validation,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_display_alv.<br />
   </div>
   <div class="codeComment">
*PRIVATE&nbsp;SECTION.<br />
<br />
*----------------------------------------------------------------------*<br />
*&nbsp;M&nbsp;E&nbsp;T&nbsp;H&nbsp;O&nbsp;D&nbsp;S<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
ENDCLASS.<br />
<br />
   </div>
   <div class="codeComment">
*----------------------------------------------------------------------*<br />
*&nbsp;S&nbsp;E&nbsp;L&nbsp;E&nbsp;C&nbsp;T&nbsp;I&nbsp;O&nbsp;N&nbsp;-&nbsp;S&nbsp;C&nbsp;R&nbsp;E&nbsp;E&nbsp;N<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
SELECTION-SCREEN BEGIN OF BLOCK b01 WITH FRAME TITLE TEXT-b01. "Xxxxx<br />
&nbsp;&nbsp;PARAMETERS:<br />
&nbsp;&nbsp;&nbsp;&nbsp;p_ocrsn&nbsp;TYPE&nbsp;t52ocrt-ocrsn,<br />
&nbsp;&nbsp;&nbsp;&nbsp;p_begda&nbsp;TYPE&nbsp;pa0267-begda.<br />
&nbsp;&nbsp;SELECT-OPTIONS:<br />
&nbsp;&nbsp;&nbsp;&nbsp;s_lgart&nbsp;FOR&nbsp;t512t-lgart&nbsp;NO&nbsp;INTERVALS.&nbsp;"Wage&nbsp;Type<br />
SELECTION-SCREEN END OF BLOCK b01.<br />
<br />
   </div>
   <div class="codeComment">
*----------------------------------------------------------------------*<br />
*&nbsp;I&nbsp;N&nbsp;I&nbsp;T&nbsp;I&nbsp;A&nbsp;L&nbsp;I&nbsp;Z&nbsp;A&nbsp;T&nbsp;I&nbsp;O&nbsp;N<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
INITIALIZATION.<br />
&nbsp;&nbsp;pnptimed&nbsp;=&nbsp;gc_pcce_eval_period.<br />
&nbsp;&nbsp;IF&nbsp;sy-datum+4(2)&nbsp;EQ&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;pnppabrj&nbsp;=&nbsp;sy-datum(4)&nbsp;-&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;pnppabrp&nbsp;=&nbsp;gc_pcce_eval_period.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;pnppabrj&nbsp;=&nbsp;sy-datum(4).<br />
&nbsp;&nbsp;&nbsp;&nbsp;pnppabrp&nbsp;=&nbsp;sy-datum+4(2)&nbsp;-&nbsp;1.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*----------------------------------------------------------------------*<br />
*&nbsp;A&nbsp;T&nbsp;&nbsp;&nbsp;S&nbsp;E&nbsp;L&nbsp;E&nbsp;C&nbsp;T&nbsp;I&nbsp;O&nbsp;N&nbsp;-&nbsp;S&nbsp;C&nbsp;R&nbsp;E&nbsp;E&nbsp;N<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
AT SELECTION-SCREEN.<br />
<br />
&nbsp;&nbsp;IF&nbsp;zab_cl_ricefw=&gt;is_process_active(&nbsp;iv_prcod&nbsp;=&nbsp;gc_procid_01&nbsp;)&nbsp;EQ&nbsp;abap_false.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;e017(zab)&nbsp;WITH&nbsp;gc_procid_01.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*----------------------------------------------------------------------*<br />
*&nbsp;S&nbsp;T&nbsp;A&nbsp;R&nbsp;T&nbsp;-&nbsp;O&nbsp;F&nbsp;-&nbsp;S&nbsp;E&nbsp;L&nbsp;E&nbsp;C&nbsp;T&nbsp;I&nbsp;O&nbsp;N<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
START-OF-SELECTION.<br />
&nbsp;&nbsp;"Instantiate&nbsp;ALV&nbsp;Class<br />
&nbsp;&nbsp;DATA(lo_class)&nbsp;=&nbsp;NEW&nbsp;lcl_class(&nbsp;).<br />
&nbsp;&nbsp;lo_class-&gt;f_populate_range_date(&nbsp;).<br />
&nbsp;&nbsp;lo_class-&gt;f_get_dtl(&nbsp;).<br />
<br />
GET peras.<br />
<br />
&nbsp;&nbsp;lo_class-&gt;f_get_data(&nbsp;).<br />
<br />
   </div>
   <div class="codeComment">
*----------------------------------------------------------------------*<br />
*&nbsp;E&nbsp;N&nbsp;D&nbsp;-&nbsp;O&nbsp;F&nbsp;-&nbsp;S&nbsp;E&nbsp;L&nbsp;E&nbsp;C&nbsp;T&nbsp;I&nbsp;O&nbsp;N<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
END-OF-SELECTION.<br />
&nbsp;&nbsp;lo_class-&gt;f_validation(&nbsp;).<br />
&nbsp;&nbsp;IF&nbsp;gt_report[]&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lo_class-&gt;f_display_alv(&nbsp;).<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;TEXT-m01&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*----------------------------------------------------------------------*<br />
*&nbsp;C&nbsp;L&nbsp;A&nbsp;S&nbsp;S&nbsp;&nbsp;&nbsp;I&nbsp;M&nbsp;P&nbsp;L&nbsp;E&nbsp;M&nbsp;E&nbsp;N&nbsp;T&nbsp;A&nbsp;T&nbsp;I&nbsp;O&nbsp;N<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
CLASS lcl_class IMPLEMENTATION.<br />
<br />
&nbsp;&nbsp;METHOD&nbsp;f_populate_range_date.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;gv_begda.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;pn-begda+0(4)&nbsp;pn-begda+4(2)&nbsp;gc_date_01<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;gv_begda.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"populate&nbsp;endda<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'RP_LAST_DAY_OF_MONTHS'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;day_in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gv_begda<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last_day_of_month&nbsp;=&nbsp;gv_endda<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;day_in_no_date&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;sy-msgid&nbsp;TYPE&nbsp;fiehc_con_msgty_s&nbsp;NUMBER&nbsp;sy-msgno<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;sy-msgv1&nbsp;sy-msgv2&nbsp;sy-msgv3&nbsp;sy-msgv4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DISPLAY&nbsp;LIKE&nbsp;fiehc_con_msgty_e.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;LIST-PROCESSING.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDMETHOD.<br />
<br />
&nbsp;&nbsp;METHOD&nbsp;f_get_data.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;DATA:&nbsp;lw_report&nbsp;&nbsp;TYPE&nbsp;gty_report,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lw_t001&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;gty_t001,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lw_tgsbt&nbsp;&nbsp;&nbsp;TYPE&nbsp;gty_tgsbt,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lw_t512t&nbsp;&nbsp;&nbsp;TYPE&nbsp;gty_t512t,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lw_t52ocrt&nbsp;TYPE&nbsp;gty_t52ocrt.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;REFRESH&nbsp;p0001.<br />
&nbsp;&nbsp;&nbsp;&nbsp;rp_read_infotype&nbsp;peras-pernr&nbsp;0001&nbsp;p0001&nbsp;gv_begda&nbsp;gv_endda.<br />
&nbsp;&nbsp;&nbsp;&nbsp;rp_provide_from_last&nbsp;p0001&nbsp;space&nbsp;gv_begda&nbsp;gv_endda.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;REFRESH&nbsp;p0032.<br />
&nbsp;&nbsp;&nbsp;&nbsp;rp_read_infotype&nbsp;peras-pernr&nbsp;0032&nbsp;p0032&nbsp;gv_begda&nbsp;gv_endda.<br />
&nbsp;&nbsp;&nbsp;&nbsp;rp_provide_from_last&nbsp;p0032&nbsp;space&nbsp;gv_begda&nbsp;gv_endda.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;REFRESH&nbsp;p0267.<br />
&nbsp;&nbsp;&nbsp;&nbsp;rp_read_infotype&nbsp;peras-pernr&nbsp;0267&nbsp;p0267&nbsp;gv_begda&nbsp;gv_endda.<br />
&nbsp;&nbsp;&nbsp;&nbsp;rp_provide_from_last&nbsp;p0267&nbsp;space&nbsp;gv_begda&nbsp;gv_endda.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;p0267-pernr&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Infotype&nbsp;PA0267<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lw_report-lgart&nbsp;=&nbsp;p0267-lgart.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lw_report-betrg&nbsp;=&nbsp;p0267-betrg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lw_report-waers&nbsp;=&nbsp;p0267-waers.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lw_report-pernr&nbsp;=&nbsp;p0267-pernr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lw_report-ocrsn&nbsp;=&nbsp;p0267-ocrsn.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Infotype&nbsp;PA0001<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lw_report-bukrs&nbsp;=&nbsp;p0001-bukrs.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lw_report-gsber&nbsp;=&nbsp;p0001-gsber.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lw_report-count&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lw_report-ename&nbsp;=&nbsp;p0001-ename.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Infotype&nbsp;PA0032<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lw_report-pnalt&nbsp;=&nbsp;p0032-pnalt.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Text&nbsp;Kode&nbsp;Perusahaan<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_t001&nbsp;INTO&nbsp;lw_t001&nbsp;WITH&nbsp;KEY&nbsp;bukrs&nbsp;=&nbsp;lw_report-bukrs&nbsp;BINARY&nbsp;SEARCH.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lw_report-butxt&nbsp;=&nbsp;lw_t001-butxt.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Text&nbsp;Bisnis&nbsp;Area<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_tgsbt&nbsp;INTO&nbsp;lw_tgsbt&nbsp;WITH&nbsp;KEY&nbsp;gsber&nbsp;=&nbsp;lw_report-gsber&nbsp;BINARY&nbsp;SEARCH.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lw_report-gtext&nbsp;=&nbsp;lw_tgsbt-gtext.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Text&nbsp;Wage&nbsp;Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_t512t&nbsp;INTO&nbsp;lw_t512t&nbsp;WITH&nbsp;KEY&nbsp;lgart&nbsp;=&nbsp;lw_report-lgart&nbsp;BINARY&nbsp;SEARCH.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lw_report-lgtxt&nbsp;=&nbsp;lw_t512t-lgtxt.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Text&nbsp;Reason&nbsp;Off&nbsp;Cycle&nbsp;Payroll<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_t52ocrt&nbsp;INTO&nbsp;lw_t52ocrt&nbsp;WITH&nbsp;KEY&nbsp;ocrsn&nbsp;=&nbsp;lw_report-ocrsn&nbsp;BINARY&nbsp;SEARCH.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lw_report-ocrtx&nbsp;=&nbsp;lw_t52ocrt-ocrtx.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;lw_report&nbsp;TO&nbsp;gt_report.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;lw_report.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDMETHOD.<br />
<br />
&nbsp;&nbsp;METHOD&nbsp;f_display_alv.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;DATA:&nbsp;lo_aggr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cl_salv_aggregations,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lo_alv_alv_column&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cl_salv_column.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;TRY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;cl_salv_table=&gt;factory<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list_display&nbsp;=&nbsp;if_salv_c_bool_sap=&gt;false<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r_salv_table&nbsp;=&nbsp;o_salv<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t_table&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_report[].<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;cx_salv_msg&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDTRY.<br />
<br />
   </div>
   <div class="codeComment">
*	Set&nbsp;screen&nbsp;status:<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;o_salv-&gt;set_screen_status(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;report&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-repid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ABAP&nbsp;Program:&nbsp;Current&nbsp;Master&nbsp;Program<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pfstatus&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'STANDARD'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Screens,&nbsp;Current&nbsp;GUI&nbsp;Status<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_functions&nbsp;=&nbsp;o_salv-&gt;c_functions_all&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALV:&nbsp;Data&nbsp;Element&nbsp;for&nbsp;Constants<br />
&nbsp;&nbsp;&nbsp;&nbsp;).<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;Get&nbsp;Aggregations<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;lo_aggr&nbsp;=&nbsp;o_salv-&gt;get_aggregations(&nbsp;).<br />
<br />
   </div>
   <div class="codeComment">
*	Get&nbsp;functions:<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;DATA(lo_functions)&nbsp;=&nbsp;o_salv-&gt;get_functions(&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;lo_functions-&gt;set_all(&nbsp;abap_true&nbsp;).<br />
<br />
   </div>
   <div class="codeComment">
*	Get&nbsp;Columns<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;o_salv-&gt;get_columns<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RECEIVING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;o_alv_columns_table.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;o_alv_columns_table-&gt;set_optimize(&nbsp;abap_true&nbsp;).<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;Set&nbsp;kolom&nbsp;yang&nbsp;akan&nbsp;di-SUM<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;TRY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lo_aggr-&gt;add_aggregation(&nbsp;'COUNT'&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;cx_salv_not_found&nbsp;&nbsp;&nbsp;&nbsp;##NO_HANDLER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;cx_salv_data_error&nbsp;&nbsp;&nbsp;##NO_HANDLER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;cx_salv_existing&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##NO_HANDLER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDTRY.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;TRY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lo_aggr-&gt;add_aggregation(&nbsp;'BETRG'&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;cx_salv_not_found&nbsp;&nbsp;&nbsp;&nbsp;##NO_HANDLER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;cx_salv_data_error&nbsp;&nbsp;&nbsp;##NO_HANDLER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;cx_salv_existing&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##NO_HANDLER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDTRY.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;TRY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;o_alv_columns_table-&gt;get_column&nbsp;EXPORTING&nbsp;columnname&nbsp;=&nbsp;'BUKRS'&nbsp;RECEIVING&nbsp;value&nbsp;=&nbsp;lo_alv_alv_column.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lo_alv_alv_column&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##NO_TEXT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lo_alv_alv_column-&gt;set_medium_text&nbsp;EXPORTING&nbsp;value&nbsp;=&nbsp;'Company&nbsp;Code'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##NO_TEXT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lo_alv_alv_column-&gt;set_long_text&nbsp;EXPORTING&nbsp;value&nbsp;=&nbsp;'Company&nbsp;Code'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;cx_salv_not_found&nbsp;&nbsp;&nbsp;&nbsp;##NO_HANDLER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;cx_salv_data_error&nbsp;&nbsp;&nbsp;##NO_HANDLER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDTRY.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;TRY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;o_alv_columns_table-&gt;get_column&nbsp;EXPORTING&nbsp;columnname&nbsp;=&nbsp;'BUTXT'&nbsp;RECEIVING&nbsp;value&nbsp;=&nbsp;lo_alv_alv_column.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lo_alv_alv_column&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##NO_TEXT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lo_alv_alv_column-&gt;set_medium_text&nbsp;EXPORTING&nbsp;value&nbsp;=&nbsp;'Company&nbsp;Code&nbsp;Name'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##NO_TEXT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lo_alv_alv_column-&gt;set_long_text&nbsp;EXPORTING&nbsp;value&nbsp;=&nbsp;'Company&nbsp;Code&nbsp;Name'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;cx_salv_not_found&nbsp;&nbsp;&nbsp;&nbsp;##NO_HANDLER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;cx_salv_data_error&nbsp;&nbsp;&nbsp;##NO_HANDLER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDTRY.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;TRY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;o_alv_columns_table-&gt;get_column&nbsp;EXPORTING&nbsp;columnname&nbsp;=&nbsp;'COUNT'&nbsp;RECEIVING&nbsp;value&nbsp;=&nbsp;lo_alv_alv_column.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lo_alv_alv_column&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##NO_TEXT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lo_alv_alv_column-&gt;set_medium_text&nbsp;EXPORTING&nbsp;value&nbsp;=&nbsp;'Count'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##NO_TEXT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lo_alv_alv_column-&gt;set_long_text&nbsp;EXPORTING&nbsp;value&nbsp;=&nbsp;'Count'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;cx_salv_not_found&nbsp;&nbsp;&nbsp;&nbsp;##NO_HANDLER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;cx_salv_data_error&nbsp;&nbsp;&nbsp;##NO_HANDLER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDTRY.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;TRY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;o_alv_columns_table-&gt;get_column&nbsp;EXPORTING&nbsp;columnname&nbsp;=&nbsp;'BETRG'&nbsp;RECEIVING&nbsp;value&nbsp;=&nbsp;lo_alv_alv_column.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lo_alv_alv_column&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##NO_TEXT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lo_alv_alv_column-&gt;set_medium_text&nbsp;EXPORTING&nbsp;value&nbsp;=&nbsp;'Wage&nbsp;Type&nbsp;Amount'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##NO_TEXT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lo_alv_alv_column-&gt;set_long_text&nbsp;EXPORTING&nbsp;value&nbsp;=&nbsp;'Wage&nbsp;Type&nbsp;Amount&nbsp;for&nbsp;Payments'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##NO_TEXT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lo_alv_alv_column-&gt;set_currency_column(&nbsp;'WAERS'&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;cx_salv_not_found&nbsp;&nbsp;&nbsp;&nbsp;##NO_HANDLER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;cx_salv_data_error&nbsp;&nbsp;&nbsp;##NO_HANDLER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDTRY.<br />
<br />
   </div>
   <div class="codeComment">
*	Display:<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;o_salv-&gt;display(&nbsp;).<br />
<br />
&nbsp;&nbsp;ENDMETHOD.<br />
<br />
&nbsp;&nbsp;METHOD&nbsp;f_get_dtl.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;gt_t001,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_tgsbt,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_t512t,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_t52ocrt.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;Text&nbsp;Company&nbsp;Code<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;SELECT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bukrs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;butxt<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;t001<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;gt_t001.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;Text&nbsp;Bisnis&nbsp;Area<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;SELECT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gsber<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gtext<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;tgsbt<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;gt_tgsbt<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;spras&nbsp;=&nbsp;'E'.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;Text&nbsp;Wage&nbsp;type<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;SELECT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgart<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgtxt<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;t512t<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;gt_t512t<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;sprsl&nbsp;=&nbsp;'E'<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;molga&nbsp;=&nbsp;gc_molga.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;Text&nbsp;Reason&nbsp;for&nbsp;Payroll<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;SELECT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ocrsn<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ocrtx<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;t52ocrt<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;gt_t52ocrt<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;sprsl&nbsp;=&nbsp;'E'<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;molga&nbsp;=&nbsp;gc_molga.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;Sort<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;gt_t001&nbsp;&nbsp;&nbsp;&nbsp;BY&nbsp;bukrs.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;gt_tgsbt&nbsp;&nbsp;&nbsp;BY&nbsp;gsber.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;gt_t512t&nbsp;&nbsp;&nbsp;BY&nbsp;lgart.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;gt_t52ocrt&nbsp;BY&nbsp;ocrsn.<br />
<br />
&nbsp;&nbsp;ENDMETHOD.<br />
<br />
&nbsp;&nbsp;METHOD&nbsp;f_validation.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;Validate&nbsp;Wage&nbsp;type<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;s_lgart-low&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;gt_report&nbsp;WHERE&nbsp;lgart&nbsp;NOT&nbsp;IN&nbsp;s_lgart.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;Validate&nbsp;Reason<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;p_ocrsn&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;gt_report&nbsp;WHERE&nbsp;ocrsn&nbsp;NE&nbsp;p_ocrsn.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;Validate&nbsp;Date&nbsp;Off-payroll<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;p_begda&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;gt_report&nbsp;WHERE&nbsp;begda&nbsp;LE&nbsp;p_begda.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDMETHOD.<br />
ENDCLASS.<br />
<br />
   </div>
   <div class="codeComment">
*Text&nbsp;elements<br />
*----------------------------------------------------------<br />
*&nbsp;B01&nbsp;Program&nbsp;Selection<br />
*&nbsp;M01&nbsp;Tidak&nbsp;ada&nbsp;data&nbsp;di&nbsp;tabel&nbsp;PA0267&nbsp;sehingga&nbsp;tidak&nbsp;bisa&nbsp;menjalankan&nbsp;proses<br />
<br />
<br />
*Selection&nbsp;texts<br />
*----------------------------------------------------------<br />
*&nbsp;P_BEGDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Off-cycle&nbsp;payroll<br />
*&nbsp;P_OCRSN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reason&nbsp;for&nbsp;payroll<br />
*&nbsp;S_LGART&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Wage&nbsp;Type<br />
<br />
<br />
*Messages<br />
*----------------------------------------------------------<br />
*<br />
*&nbsp;Message&nbsp;class:&nbsp;ZAB<br />
*017&nbsp;&nbsp;&nbsp;Process&nbsp;Code&nbsp;&&nbsp;is&nbsp;not&nbsp;active<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">Extracted by Mass Download version 1.5.5 - E.G.Mellodew. 1998-2025. Sap Release 758</td>
   </tr>
</table>
</body>
</html>
