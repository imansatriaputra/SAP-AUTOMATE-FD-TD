{
  "version": 3,
  "sources": ["../../@webcontainer/api/dist/internal/constants.js", "../../@webcontainer/api/dist/internal/TypedEventTarget.js", "../../@webcontainer/api/dist/internal/tokens.js", "../../@webcontainer/api/dist/internal/iframe-url.js", "../../@webcontainer/api/dist/internal/code.js", "../../@webcontainer/api/dist/internal/reset-promise.js", "../../@webcontainer/api/dist/internal/auth-state.js", "../../@webcontainer/api/dist/preview-message-types.js", "../../@webcontainer/api/dist/vendor/index.js", "../../@webcontainer/api/dist/utils/reload-preview.js", "../../@webcontainer/api/dist/utils/is-preview-message.js", "../../@webcontainer/api/dist/utils/null-prototype.js", "../../@webcontainer/api/dist/utils/file-system.js", "../../@webcontainer/api/dist/index.js"],
  "sourcesContent": ["export const DEFAULT_EDITOR_ORIGIN = 'https://stackblitz.com';\r\nexport const SEARCH_PARAM_AUTH_CODE = 'code';\r\nexport const SEARCH_PARAM_ERROR = 'error';\r\nexport const SEARCH_PARAM_ERROR_DESCRIPTION = 'error_description';\r\nexport const BROADCAST_CHANNEL_NAME = '__wc_api_bc__';\r\nexport const STORAGE_TOKENS_NAME = '__wc_api_tokens__';\r\nexport const STORAGE_CODE_VERIFIER_NAME = '__wc_api_verifier__';\r\nexport const STORAGE_POPUP_NAME = '__wc_api_popup__';\r\n", "export class TypedEventTarget {\r\n    _bus = new EventTarget();\r\n    listen(listener) {\r\n        function wrappedListener(event) {\r\n            listener(event.data);\r\n        }\r\n        this._bus.addEventListener('message', wrappedListener);\r\n        return () => this._bus.removeEventListener('message', wrappedListener);\r\n    }\r\n    fireEvent(data) {\r\n        this._bus.dispatchEvent(new MessageEvent('message', { data }));\r\n    }\r\n}\r\n", "import { STORAGE_TOKENS_NAME } from './constants.js';\r\nimport { TypedEventTarget } from './TypedEventTarget.js';\r\nconst IGNORED_ERROR = new Error();\r\nIGNORED_ERROR.stack = '';\r\nconst accessTokenChangedListeners = new TypedEventTarget();\r\n/**\r\n * @internal\r\n */\r\nexport class Tokens {\r\n    origin;\r\n    refresh;\r\n    access;\r\n    expires;\r\n    _revoked = new AbortController();\r\n    constructor(\r\n    // editor origin that those tokens are bound to, mostly used for development\r\n    origin, \r\n    // token to use to get a new access token\r\n    refresh, \r\n    // token to provide to webcontainer\r\n    access, \r\n    // time in UTC when the token expires\r\n    expires) {\r\n        this.origin = origin;\r\n        this.refresh = refresh;\r\n        this.access = access;\r\n        this.expires = expires;\r\n    }\r\n    async activate(onFailedRefresh) {\r\n        if (this._revoked.signal.aborted) {\r\n            throw new Error('Token revoked');\r\n        }\r\n        // if the access token expired we fetch a new one\r\n        if (this.expires < Date.now()) {\r\n            if (!(await this._fetchNewAccessToken())) {\r\n                return false;\r\n            }\r\n        }\r\n        this._sync();\r\n        this._startRefreshTokensLoop(onFailedRefresh);\r\n        return true;\r\n    }\r\n    async revoke(clientId, ignoreRevokeError) {\r\n        this._revoked.abort();\r\n        try {\r\n            const response = await fetch(`${this.origin}/oauth/revoke`, {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/x-www-form-urlencoded',\r\n                },\r\n                body: new URLSearchParams({ token: this.refresh, token_type_hint: 'refresh_token', client_id: clientId }),\r\n                mode: 'cors',\r\n            });\r\n            if (!response.ok) {\r\n                throw new Error(`Failed to logout`);\r\n            }\r\n        }\r\n        catch (error) {\r\n            if (!ignoreRevokeError) {\r\n                throw error;\r\n            }\r\n        }\r\n        clearTokensInStorage();\r\n    }\r\n    static fromStorage() {\r\n        const savedTokens = readTokensFromStorage();\r\n        if (!savedTokens) {\r\n            return null;\r\n        }\r\n        return new Tokens(savedTokens.origin, savedTokens.refresh, savedTokens.access, savedTokens.expires);\r\n    }\r\n    static async fromAuthCode({ editorOrigin, clientId, codeVerifier, authCode, redirectUri, }) {\r\n        const response = await fetch(`${editorOrigin}/oauth/token`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/x-www-form-urlencoded',\r\n            },\r\n            body: new URLSearchParams({\r\n                client_id: clientId,\r\n                code: authCode,\r\n                code_verifier: codeVerifier,\r\n                grant_type: 'authorization_code',\r\n                redirect_uri: redirectUri,\r\n            }),\r\n            mode: 'cors',\r\n        });\r\n        if (!response.ok) {\r\n            throw new Error(`Failed to fetch token: ${response.status}`);\r\n        }\r\n        const tokenResponse = await response.json();\r\n        assertTokenResponse(tokenResponse);\r\n        const { access_token: access, refresh_token: refresh } = tokenResponse;\r\n        const expires = getExpiresFromTokenResponse(tokenResponse);\r\n        return new Tokens(editorOrigin, refresh, access, expires);\r\n    }\r\n    async _fetchNewAccessToken() {\r\n        try {\r\n            const response = await fetch(`${this.origin}/oauth/token`, {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/x-www-form-urlencoded',\r\n                },\r\n                body: new URLSearchParams({\r\n                    grant_type: 'refresh_token',\r\n                    refresh_token: this.refresh,\r\n                }),\r\n                mode: 'cors',\r\n                signal: this._revoked.signal,\r\n            });\r\n            if (!response.ok) {\r\n                throw IGNORED_ERROR;\r\n            }\r\n            const tokenResponse = await response.json();\r\n            assertTokenResponse(tokenResponse);\r\n            const { access_token: access, refresh_token: refresh } = tokenResponse;\r\n            const expires = getExpiresFromTokenResponse(tokenResponse);\r\n            this.access = access;\r\n            this.expires = expires;\r\n            this.refresh = refresh;\r\n            return true;\r\n        }\r\n        catch {\r\n            clearTokensInStorage();\r\n            return false;\r\n        }\r\n    }\r\n    _sync() {\r\n        persistTokensInStorage(this);\r\n        fireAccessTokenChanged(this.access);\r\n    }\r\n    async _startRefreshTokensLoop(onFailedRefresh) {\r\n        while (true) {\r\n            const expiresIn = this.expires - Date.now() - 1000;\r\n            await wait(Math.max(expiresIn, 1000));\r\n            if (this._revoked.signal.aborted) {\r\n                return;\r\n            }\r\n            if (!this._fetchNewAccessToken()) {\r\n                onFailedRefresh();\r\n                return;\r\n            }\r\n            this._sync();\r\n        }\r\n    }\r\n}\r\n/**\r\n * @internal\r\n */\r\nexport function clearTokensInStorage() {\r\n    localStorage.removeItem(STORAGE_TOKENS_NAME);\r\n}\r\n/**\r\n * @internal\r\n */\r\nexport function addAccessTokenChangedListener(listener) {\r\n    return accessTokenChangedListeners.listen(listener);\r\n}\r\nfunction readTokensFromStorage() {\r\n    const serializedTokens = localStorage.getItem(STORAGE_TOKENS_NAME);\r\n    if (!serializedTokens) {\r\n        return null;\r\n    }\r\n    try {\r\n        return JSON.parse(serializedTokens);\r\n    }\r\n    catch {\r\n        return null;\r\n    }\r\n}\r\nfunction persistTokensInStorage(tokens) {\r\n    localStorage.setItem(STORAGE_TOKENS_NAME, JSON.stringify(tokens));\r\n}\r\nfunction getExpiresFromTokenResponse({ created_at, expires_in }) {\r\n    return (created_at + expires_in) * 1000;\r\n}\r\nfunction assertTokenResponse(token) {\r\n    if (typeof token !== 'object' || !token) {\r\n        throw new Error('Invalid Token Response');\r\n    }\r\n    if (typeof token.access_token !== 'string' ||\r\n        typeof token.refresh_token !== 'string' ||\r\n        typeof token.created_at !== 'number' ||\r\n        typeof token.expires_in !== 'number') {\r\n        throw new Error('Invalid Token Response');\r\n    }\r\n}\r\nfunction wait(ms) {\r\n    return new Promise((resolve) => setTimeout(resolve, ms));\r\n}\r\nfunction fireAccessTokenChanged(accessToken) {\r\n    accessTokenChangedListeners.fireEvent(accessToken);\r\n}\r\n", "import { DEFAULT_EDITOR_ORIGIN } from './constants.js';\r\nconst params = {};\r\nlet editorOrigin = null;\r\nexport const iframeSettings = {\r\n    get editorOrigin() {\r\n        if (editorOrigin == null) {\r\n            editorOrigin = new URL(globalThis.WEBCONTAINER_API_IFRAME_URL ?? DEFAULT_EDITOR_ORIGIN).origin;\r\n        }\r\n        return editorOrigin;\r\n    },\r\n    set editorOrigin(newOrigin) {\r\n        editorOrigin = new URL(newOrigin).origin;\r\n    },\r\n    setQueryParam(key, value) {\r\n        params[key] = value;\r\n    },\r\n    get url() {\r\n        const url = new URL(this.editorOrigin);\r\n        url.pathname = '/headless';\r\n        for (const param in params) {\r\n            url.searchParams.set(param, params[param]);\r\n        }\r\n        url.searchParams.set('version', \"1.6.1\");\r\n        return url;\r\n    },\r\n};\r\n", "/**\r\n * Implementation of https://www.rfc-editor.org/rfc/rfc7636#section-4.2 that can\r\n * run in the browser.\r\n *\r\n * @internal\r\n *\r\n * @param input Code verifier.\r\n */\r\nexport async function S256(input) {\r\n    // input here is assumed to match https://www.rfc-editor.org/rfc/rfc3986#section-2.3\r\n    const ascii = new TextEncoder().encode(input);\r\n    const sha256 = new Uint8Array(await crypto.subtle.digest('SHA-256', ascii));\r\n    // base64url encode, based on https://developer.mozilla.org/en-US/docs/Glossary/Base64#the_unicode_problem\r\n    return btoa(sha256.reduce((binary, byte) => binary + String.fromCodePoint(byte), ''))\r\n        .replace(/\\+/g, '-')\r\n        .replace(/\\//g, '_')\r\n        .replace(/=+$/, '');\r\n}\r\n/**\r\n * Implementation of https://www.rfc-editor.org/rfc/rfc7636#section-4.1 with\r\n * a slight deviation:\r\n *\r\n *  - We use 128 characters (it's expected to be between 43 and 128)\r\n *  - We use 64 characters instead of 66\r\n *\r\n * So the entropy is lower given the space size is 64^128 instead of 66^128.\r\n * It still satisfies the entropy constraint given that 64^128 > 66^43.\r\n *\r\n * @internal\r\n */\r\nexport function newCodeVerifier() {\r\n    const random = new Uint8Array(96);\r\n    crypto.getRandomValues(random);\r\n    let codeVerifier = '';\r\n    for (let i = 0; i < 32; ++i) {\r\n        codeVerifier += nextFourChars(random[3 * i + 0], random[3 * i + 1], random[3 * i + 2]);\r\n    }\r\n    return codeVerifier;\r\n}\r\nfunction nextFourChars(byte1, byte2, byte3) {\r\n    const char1 = byte1 >> 2;\r\n    const char2 = ((byte1 & 3) << 4) | (byte2 >> 4);\r\n    const char3 = (byte2 & 15) | ((byte3 & 192) >> 2);\r\n    const char4 = byte3 & 63;\r\n    return [char1, char2, char3, char4].map(unreservedCharacters).join('');\r\n}\r\nfunction unreservedCharacters(code) {\r\n    let offset;\r\n    if (code < 26) {\r\n        offset = code + 65; // [A-Z]\r\n    }\r\n    else if (code < 52) {\r\n        offset = code - 26 + 97; // [a-z]\r\n    }\r\n    else if (code < 62) {\r\n        offset = code - 52 + 48; // [0-9]\r\n    }\r\n    else {\r\n        offset = code === 62 ? 30 /* _ */ : 45 /* - */;\r\n    }\r\n    return String.fromCharCode(offset);\r\n}\r\n", "/**\r\n * @internal\r\n */\r\nexport function resettablePromise() {\r\n    let resolve;\r\n    let promise;\r\n    function reset() {\r\n        promise = new Promise((_resolve) => (resolve = _resolve));\r\n    }\r\n    reset();\r\n    return {\r\n        get promise() {\r\n            return promise;\r\n        },\r\n        resolve(value) {\r\n            return resolve(value);\r\n        },\r\n        reset,\r\n    };\r\n}\r\n", "import { Tokens, clearTokensInStorage } from './tokens.js';\r\nimport { SEARCH_PARAM_AUTH_CODE, SEARCH_PARAM_ERROR, STORAGE_CODE_VERIFIER_NAME, BROADCAST_CHANNEL_NAME, STORAGE_POPUP_NAME, SEARCH_PARAM_ERROR_DESCRIPTION, } from './constants.js';\r\nimport { iframeSettings } from './iframe-url.js';\r\nimport { S256, newCodeVerifier } from './code.js';\r\nimport { resettablePromise } from './reset-promise.js';\r\nimport { TypedEventTarget } from './TypedEventTarget.js';\r\n/**\r\n * @internal\r\n */\r\nexport const authState = {\r\n    initialized: false,\r\n    bootCalled: false,\r\n    authComplete: resettablePromise(),\r\n    clientId: '',\r\n    oauthScope: '',\r\n    broadcastChannel: null,\r\n    get editorOrigin() {\r\n        return iframeSettings.editorOrigin;\r\n    },\r\n    tokens: null,\r\n};\r\nconst authFailedListeners = new TypedEventTarget();\r\nconst loggedOutListeners = new TypedEventTarget();\r\nfunction broadcastMessage(message) {\r\n    if (!authState.broadcastChannel) {\r\n        return;\r\n    }\r\n    authState.broadcastChannel.postMessage(message);\r\n    // check if we are in a popup mode\r\n    if (localStorage.getItem(STORAGE_POPUP_NAME) === 'true' && message.type !== 'auth-logout') {\r\n        localStorage.removeItem(STORAGE_POPUP_NAME);\r\n        // wait a tick to make sure the posted message has been sent\r\n        setTimeout(() => {\r\n            window.close();\r\n        });\r\n    }\r\n}\r\nexport const auth = {\r\n    init({ editorOrigin, clientId, scope }) {\r\n        if (authState.initialized) {\r\n            throw new Error('Init should only be called once');\r\n        }\r\n        let enterprise = true;\r\n        if (enterprise && authState.bootCalled) {\r\n            throw new Error('`auth.init` should always be called before `WebContainer.boot`');\r\n        }\r\n        authState.initialized = true;\r\n        authState.tokens = Tokens.fromStorage();\r\n        authState.clientId = clientId;\r\n        authState.oauthScope = scope;\r\n        authState.broadcastChannel = new BroadcastChannel(BROADCAST_CHANNEL_NAME);\r\n        // configure iframe url\r\n        iframeSettings.setQueryParam('client_id', clientId);\r\n        if (editorOrigin) {\r\n            iframeSettings.editorOrigin = new URL(editorOrigin).origin;\r\n        }\r\n        loggedOutListeners.listen(() => authState.authComplete.reset());\r\n        // if authentication or logout are done in another page, we want to reflect the state on this page as well\r\n        authState.broadcastChannel.addEventListener('message', onChannelMessage);\r\n        async function onChannelMessage(event) {\r\n            const typedEvent = event.data;\r\n            if (typedEvent.type === 'auth-complete') {\r\n                authState.tokens = Tokens.fromStorage();\r\n                // we ignore the possible error here because they can't have expired just yet\r\n                await authState.tokens.activate(onFailedTokenRefresh);\r\n                authState.authComplete.resolve();\r\n                return;\r\n            }\r\n            if (typedEvent.type === 'auth-failed') {\r\n                authFailedListeners.fireEvent(typedEvent);\r\n                return;\r\n            }\r\n            if (typedEvent.type === 'auth-logout') {\r\n                loggedOutListeners.fireEvent();\r\n                return;\r\n            }\r\n        }\r\n        if (authState.tokens) {\r\n            const tokens = authState.tokens;\r\n            if (tokens.origin === authState.editorOrigin) {\r\n                /**\r\n                 * Here we assume that the refresh token never expires which\r\n                 * might not be correct. If that is the case though, we will\r\n                 * emit a 'logged-out' event to signal that the user has been\r\n                 * logged out, which could also happen at a later time anyway.\r\n                 *\r\n                 * Because this flow is done entirely locally, we do not broadcast\r\n                 * anything to the other tabs. They should be performing a similar\r\n                 * check.\r\n                 */\r\n                (async () => {\r\n                    const success = await tokens.activate(onFailedTokenRefresh);\r\n                    if (!success) {\r\n                        // if we got new token in the meantime we discard this error\r\n                        if (authState.tokens !== tokens) {\r\n                            return;\r\n                        }\r\n                        loggedOutListeners.fireEvent();\r\n                        return;\r\n                    }\r\n                    authState.authComplete.resolve();\r\n                })();\r\n                return { status: 'authorized' };\r\n            }\r\n            clearTokensInStorage();\r\n            authState.tokens = null;\r\n        }\r\n        const locationURL = new URL(window.location.href);\r\n        const { searchParams } = locationURL;\r\n        const updateURL = () => window.history.replaceState({}, document.title, locationURL);\r\n        // check for errors first, aka the user declined the authorisation or stackblitz did\r\n        if (searchParams.has(SEARCH_PARAM_ERROR)) {\r\n            const error = searchParams.get(SEARCH_PARAM_ERROR);\r\n            const description = searchParams.get(SEARCH_PARAM_ERROR_DESCRIPTION);\r\n            searchParams.delete(SEARCH_PARAM_ERROR);\r\n            searchParams.delete(SEARCH_PARAM_ERROR_DESCRIPTION);\r\n            updateURL();\r\n            broadcastMessage({ type: 'auth-failed', error, description });\r\n            return { status: 'auth-failed', error, description };\r\n        }\r\n        // if there's an auth code\r\n        if (searchParams.has(SEARCH_PARAM_AUTH_CODE)) {\r\n            const authCode = searchParams.get(SEARCH_PARAM_AUTH_CODE);\r\n            const editorOrigin = authState.editorOrigin;\r\n            searchParams.delete(SEARCH_PARAM_AUTH_CODE);\r\n            updateURL();\r\n            const codeVerifier = localStorage.getItem(STORAGE_CODE_VERIFIER_NAME);\r\n            if (!codeVerifier) {\r\n                return { status: 'need-auth' };\r\n            }\r\n            localStorage.removeItem(STORAGE_CODE_VERIFIER_NAME);\r\n            Tokens.fromAuthCode({\r\n                editorOrigin,\r\n                clientId: authState.clientId,\r\n                authCode,\r\n                codeVerifier,\r\n                redirectUri: defaultRedirectUri(),\r\n            })\r\n                .then(async (tokens) => {\r\n                authState.tokens = tokens;\r\n                assertAuthTokens(authState.tokens);\r\n                const success = await authState.tokens.activate(onFailedTokenRefresh);\r\n                // if authentication failed we throw, and we'll mark auth as failed\r\n                if (!success) {\r\n                    throw new Error();\r\n                }\r\n                authState.authComplete.resolve();\r\n                broadcastMessage({ type: 'auth-complete' });\r\n            })\r\n                .catch((error) => {\r\n                // this should never happen unless the rails app is now down for some reason?\r\n                console.error(error);\r\n                // treat it as a logged out event so that the user can retry to login\r\n                loggedOutListeners.fireEvent();\r\n                broadcastMessage({ type: 'auth-logout' });\r\n            });\r\n            return { status: 'authorized' };\r\n        }\r\n        return { status: 'need-auth' };\r\n    },\r\n    async startAuthFlow({ popup } = {}) {\r\n        if (!authState.initialized) {\r\n            throw new Error('auth.init must be called first');\r\n        }\r\n        if (popup) {\r\n            localStorage.setItem(STORAGE_POPUP_NAME, 'true');\r\n            const height = 500;\r\n            const width = 620;\r\n            const left = window.screenLeft + (window.outerWidth - width) / 2;\r\n            const top = window.screenTop + (window.outerHeight - height) / 2;\r\n            window.open(await generateOAuthRequest(), '_blank', `popup,width=${width},height=${height},left=${left},top=${top}`);\r\n        }\r\n        else {\r\n            window.location.href = await generateOAuthRequest();\r\n        }\r\n    },\r\n    async logout({ ignoreRevokeError } = {}) {\r\n        await authState.tokens?.revoke(authState.clientId, ignoreRevokeError ?? false);\r\n        loggedOutListeners.fireEvent();\r\n        broadcastMessage({ type: 'auth-logout' });\r\n    },\r\n    loggedIn() {\r\n        return authState.authComplete.promise;\r\n    },\r\n    on(event, listener) {\r\n        switch (event) {\r\n            case 'auth-failed': {\r\n                return authFailedListeners.listen(listener);\r\n            }\r\n            case 'logged-out': {\r\n                return loggedOutListeners.listen(listener);\r\n            }\r\n            default: {\r\n                throw new Error(`Unsupported event type '${event}'.`);\r\n            }\r\n        }\r\n    },\r\n};\r\nfunction onFailedTokenRefresh() {\r\n    loggedOutListeners.fireEvent();\r\n    broadcastMessage({ type: 'auth-logout' });\r\n}\r\nfunction defaultRedirectUri() {\r\n    return window.location.href;\r\n}\r\nasync function generateOAuthRequest() {\r\n    const codeVerifier = newCodeVerifier();\r\n    localStorage.setItem(STORAGE_CODE_VERIFIER_NAME, codeVerifier);\r\n    const codeChallenge = await S256(codeVerifier);\r\n    const url = new URL('/oauth/authorize', authState.editorOrigin);\r\n    const { searchParams } = url;\r\n    searchParams.append('response_type', 'code');\r\n    searchParams.append('client_id', authState.clientId);\r\n    searchParams.append('redirect_uri', defaultRedirectUri());\r\n    searchParams.append('scope', authState.oauthScope);\r\n    searchParams.append('code_challenge', codeChallenge);\r\n    searchParams.append('code_challenge_method', 'S256');\r\n    return url.toString();\r\n}\r\n/**\r\n * @internal\r\n */\r\nexport function assertAuthTokens(tokens) {\r\n    if (!tokens) {\r\n        throw new Error('Oops! Tokens is not defined when it always should be.');\r\n    }\r\n}\r\n", "/**\r\n * This type is in a separate module so that localservice can import it\r\n * without bundling all the other webcontainer specific stuff.\r\n */\r\nexport var PreviewMessageType;\r\n(function (PreviewMessageType) {\r\n    PreviewMessageType[\"UncaughtException\"] = \"PREVIEW_UNCAUGHT_EXCEPTION\";\r\n    PreviewMessageType[\"UnhandledRejection\"] = \"PREVIEW_UNHANDLED_REJECTION\";\r\n    PreviewMessageType[\"ConsoleError\"] = \"PREVIEW_CONSOLE_ERROR\";\r\n})(PreviewMessageType || (PreviewMessageType = {}));\r\n", "var __defProp = Object.defineProperty;\r\nvar __export = (target, all) => {\r\n  for (var name in all)\r\n    __defProp(target, name, { get: all[name], enumerable: true });\r\n};\r\n\r\n// dist/vendor/comlink.js\r\nvar comlink_exports = {};\r\n__export(comlink_exports, {\r\n  createEndpoint: () => createEndpoint,\r\n  expose: () => expose,\r\n  proxy: () => proxy,\r\n  proxyMarker: () => proxyMarker,\r\n  releaseProxy: () => releaseProxy,\r\n  transfer: () => transfer,\r\n  transferHandlers: () => transferHandlers,\r\n  windowEndpoint: () => windowEndpoint,\r\n  wrap: () => wrap\r\n});\r\n\r\n// ../../node_modules/comlink/dist/esm/comlink.mjs\r\nvar proxyMarker = Symbol(\"Comlink.proxy\");\r\nvar createEndpoint = Symbol(\"Comlink.endpoint\");\r\nvar releaseProxy = Symbol(\"Comlink.releaseProxy\");\r\nvar throwMarker = Symbol(\"Comlink.thrown\");\r\nvar isObject = (val) => typeof val === \"object\" && val !== null || typeof val === \"function\";\r\nvar proxyTransferHandler = {\r\n  canHandle: (val) => isObject(val) && val[proxyMarker],\r\n  serialize(obj) {\r\n    const { port1, port2 } = new MessageChannel();\r\n    expose(obj, port1);\r\n    return [port2, [port2]];\r\n  },\r\n  deserialize(port) {\r\n    port.start();\r\n    return wrap(port);\r\n  }\r\n};\r\nvar throwTransferHandler = {\r\n  canHandle: (value) => isObject(value) && throwMarker in value,\r\n  serialize({ value }) {\r\n    let serialized;\r\n    if (value instanceof Error) {\r\n      serialized = {\r\n        isError: true,\r\n        value: {\r\n          message: value.message,\r\n          name: value.name,\r\n          stack: value.stack\r\n        }\r\n      };\r\n    } else {\r\n      serialized = { isError: false, value };\r\n    }\r\n    return [serialized, []];\r\n  },\r\n  deserialize(serialized) {\r\n    if (serialized.isError) {\r\n      throw Object.assign(new Error(serialized.value.message), serialized.value);\r\n    }\r\n    throw serialized.value;\r\n  }\r\n};\r\nvar transferHandlers = /* @__PURE__ */ new Map([\r\n  [\"proxy\", proxyTransferHandler],\r\n  [\"throw\", throwTransferHandler]\r\n]);\r\nfunction expose(obj, ep = self) {\r\n  ep.addEventListener(\"message\", function callback(ev) {\r\n    if (!ev || !ev.data) {\r\n      return;\r\n    }\r\n    const { id, type, path } = Object.assign({ path: [] }, ev.data);\r\n    const argumentList = (ev.data.argumentList || []).map(fromWireValue);\r\n    let returnValue;\r\n    try {\r\n      const parent = path.slice(0, -1).reduce((obj2, prop) => obj2[prop], obj);\r\n      const rawValue = path.reduce((obj2, prop) => obj2[prop], obj);\r\n      switch (type) {\r\n        case 0:\r\n          {\r\n            returnValue = rawValue;\r\n          }\r\n          break;\r\n        case 1:\r\n          {\r\n            parent[path.slice(-1)[0]] = fromWireValue(ev.data.value);\r\n            returnValue = true;\r\n          }\r\n          break;\r\n        case 2:\r\n          {\r\n            returnValue = rawValue.apply(parent, argumentList);\r\n          }\r\n          break;\r\n        case 3:\r\n          {\r\n            const value = new rawValue(...argumentList);\r\n            returnValue = proxy(value);\r\n          }\r\n          break;\r\n        case 4:\r\n          {\r\n            const { port1, port2 } = new MessageChannel();\r\n            expose(obj, port2);\r\n            returnValue = transfer(port1, [port1]);\r\n          }\r\n          break;\r\n        case 5:\r\n          {\r\n            returnValue = void 0;\r\n          }\r\n          break;\r\n      }\r\n    } catch (value) {\r\n      returnValue = { value, [throwMarker]: 0 };\r\n    }\r\n    Promise.resolve(returnValue).catch((value) => {\r\n      return { value, [throwMarker]: 0 };\r\n    }).then((returnValue2) => {\r\n      const [wireValue, transferables] = toWireValue(returnValue2);\r\n      ep.postMessage(Object.assign(Object.assign({}, wireValue), { id }), transferables);\r\n      if (type === 5) {\r\n        ep.removeEventListener(\"message\", callback);\r\n        closeEndPoint(ep);\r\n      }\r\n    });\r\n  });\r\n  if (ep.start) {\r\n    ep.start();\r\n  }\r\n}\r\nfunction isMessagePort(endpoint) {\r\n  return endpoint.constructor.name === \"MessagePort\";\r\n}\r\nfunction closeEndPoint(endpoint) {\r\n  if (isMessagePort(endpoint))\r\n    endpoint.close();\r\n}\r\nfunction wrap(ep, target) {\r\n  return createProxy(ep, [], target);\r\n}\r\nfunction throwIfProxyReleased(isReleased) {\r\n  if (isReleased) {\r\n    throw new Error(\"Proxy has been released and is not useable\");\r\n  }\r\n}\r\nfunction createProxy(ep, path = [], target = function() {\r\n}) {\r\n  let isProxyReleased = false;\r\n  const proxy2 = new Proxy(target, {\r\n    get(_target, prop) {\r\n      throwIfProxyReleased(isProxyReleased);\r\n      if (prop === releaseProxy) {\r\n        return () => {\r\n          return requestResponseMessage(ep, {\r\n            type: 5,\r\n            path: path.map((p) => p.toString())\r\n          }).then(() => {\r\n            closeEndPoint(ep);\r\n            isProxyReleased = true;\r\n          });\r\n        };\r\n      }\r\n      if (prop === \"then\") {\r\n        if (path.length === 0) {\r\n          return { then: () => proxy2 };\r\n        }\r\n        const r = requestResponseMessage(ep, {\r\n          type: 0,\r\n          path: path.map((p) => p.toString())\r\n        }).then(fromWireValue);\r\n        return r.then.bind(r);\r\n      }\r\n      return createProxy(ep, [...path, prop]);\r\n    },\r\n    set(_target, prop, rawValue) {\r\n      throwIfProxyReleased(isProxyReleased);\r\n      const [value, transferables] = toWireValue(rawValue);\r\n      return requestResponseMessage(ep, {\r\n        type: 1,\r\n        path: [...path, prop].map((p) => p.toString()),\r\n        value\r\n      }, transferables).then(fromWireValue);\r\n    },\r\n    apply(_target, _thisArg, rawArgumentList) {\r\n      throwIfProxyReleased(isProxyReleased);\r\n      const last = path[path.length - 1];\r\n      if (last === createEndpoint) {\r\n        return requestResponseMessage(ep, {\r\n          type: 4\r\n        }).then(fromWireValue);\r\n      }\r\n      if (last === \"bind\") {\r\n        return createProxy(ep, path.slice(0, -1));\r\n      }\r\n      const [argumentList, transferables] = processArguments(rawArgumentList);\r\n      return requestResponseMessage(ep, {\r\n        type: 2,\r\n        path: path.map((p) => p.toString()),\r\n        argumentList\r\n      }, transferables).then(fromWireValue);\r\n    },\r\n    construct(_target, rawArgumentList) {\r\n      throwIfProxyReleased(isProxyReleased);\r\n      const [argumentList, transferables] = processArguments(rawArgumentList);\r\n      return requestResponseMessage(ep, {\r\n        type: 3,\r\n        path: path.map((p) => p.toString()),\r\n        argumentList\r\n      }, transferables).then(fromWireValue);\r\n    }\r\n  });\r\n  return proxy2;\r\n}\r\nfunction myFlat(arr) {\r\n  return Array.prototype.concat.apply([], arr);\r\n}\r\nfunction processArguments(argumentList) {\r\n  const processed = argumentList.map(toWireValue);\r\n  return [processed.map((v) => v[0]), myFlat(processed.map((v) => v[1]))];\r\n}\r\nvar transferCache = /* @__PURE__ */ new WeakMap();\r\nfunction transfer(obj, transfers) {\r\n  transferCache.set(obj, transfers);\r\n  return obj;\r\n}\r\nfunction proxy(obj) {\r\n  return Object.assign(obj, { [proxyMarker]: true });\r\n}\r\nfunction windowEndpoint(w, context = self, targetOrigin = \"*\") {\r\n  return {\r\n    postMessage: (msg, transferables) => w.postMessage(msg, targetOrigin, transferables),\r\n    addEventListener: context.addEventListener.bind(context),\r\n    removeEventListener: context.removeEventListener.bind(context)\r\n  };\r\n}\r\nfunction toWireValue(value) {\r\n  for (const [name, handler] of transferHandlers) {\r\n    if (handler.canHandle(value)) {\r\n      const [serializedValue, transferables] = handler.serialize(value);\r\n      return [\r\n        {\r\n          type: 3,\r\n          name,\r\n          value: serializedValue\r\n        },\r\n        transferables\r\n      ];\r\n    }\r\n  }\r\n  return [\r\n    {\r\n      type: 0,\r\n      value\r\n    },\r\n    transferCache.get(value) || []\r\n  ];\r\n}\r\nfunction fromWireValue(value) {\r\n  switch (value.type) {\r\n    case 3:\r\n      return transferHandlers.get(value.name).deserialize(value.value);\r\n    case 0:\r\n      return value.value;\r\n  }\r\n}\r\nfunction requestResponseMessage(ep, msg, transfers) {\r\n  return new Promise((resolve) => {\r\n    const id = generateUUID();\r\n    ep.addEventListener(\"message\", function l(ev) {\r\n      if (!ev.data || !ev.data.id || ev.data.id !== id) {\r\n        return;\r\n      }\r\n      ep.removeEventListener(\"message\", l);\r\n      resolve(ev.data);\r\n    });\r\n    if (ep.start) {\r\n      ep.start();\r\n    }\r\n    ep.postMessage(Object.assign({ id }, msg), transfers);\r\n  });\r\n}\r\nfunction generateUUID() {\r\n  return new Array(4).fill(0).map(() => Math.floor(Math.random() * Number.MAX_SAFE_INTEGER).toString(16)).join(\"-\");\r\n}\r\nexport {\r\n  comlink_exports as Comlink\r\n};\r\n", "/**\r\n * This function reloads the provided iframe.\r\n *\r\n * @param preview The iframe page to reload.\r\n * @param hardRefreshTimeout The timeout after which the preview is reset if it hasn't responded to the reload event.\r\n */\r\nexport function reloadPreview(preview, hardRefreshTimeout = 200) {\r\n    const { port1, port2 } = new MessageChannel();\r\n    let resolve;\r\n    const promise = new Promise((_resolve) => {\r\n        resolve = _resolve;\r\n    });\r\n    const done = () => {\r\n        resolve();\r\n        port2.close();\r\n    };\r\n    const timeout = setTimeout(() => {\r\n        const iframeSrc = preview.src;\r\n        preview.src = iframeSrc;\r\n        done();\r\n    }, hardRefreshTimeout);\r\n    port2.addEventListener('message', (event) => {\r\n        const data = event.data;\r\n        if (data == null || typeof data !== 'object') {\r\n            return;\r\n        }\r\n        if (data.type === 'LOCALSERVICE_WINDOW_RELOADED') {\r\n            clearTimeout(timeout);\r\n            done();\r\n        }\r\n    });\r\n    preview.contentWindow?.postMessage({\r\n        type: 'LOCALSERVICE_RELOAD_WINDOW',\r\n        callback: port1,\r\n    }, '*', [port1]);\r\n    return promise;\r\n}\r\n", "import { PreviewMessageType } from '../preview-message-types.js';\r\nconst PREVIEW_MESSAGE_TYPES = [\r\n    PreviewMessageType.ConsoleError,\r\n    PreviewMessageType.UncaughtException,\r\n    PreviewMessageType.UnhandledRejection,\r\n];\r\nexport function isPreviewMessage(data) {\r\n    if (data == null || typeof data !== 'object') {\r\n        return false;\r\n    }\r\n    if (!('type' in data) || !PREVIEW_MESSAGE_TYPES.includes(data.type)) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n", "/**\r\n * @internal\r\n */\r\nexport function nullPrototype(source) {\r\n    const prototype = Object.create(null);\r\n    if (!source) {\r\n        return prototype;\r\n    }\r\n    return Object.assign(prototype, source);\r\n}\r\n", "import { nullPrototype } from './null-prototype.js';\r\nconst binaryDecoder = new TextDecoder('latin1');\r\n/**\r\n * @internal\r\n */\r\nexport function toInternalFileSystemTree(tree) {\r\n    const newTree = { d: {} };\r\n    for (const name of Object.keys(tree)) {\r\n        const entry = tree[name];\r\n        if ('file' in entry) {\r\n            if ('symlink' in entry.file) {\r\n                newTree.d[name] = { f: { l: entry.file.symlink } };\r\n                continue;\r\n            }\r\n            const contents = entry.file.contents;\r\n            const stringContents = typeof contents === 'string' ? contents : binaryDecoder.decode(contents);\r\n            const binary = typeof contents === 'string' ? {} : { b: true };\r\n            newTree.d[name] = { f: { c: stringContents, ...binary } };\r\n            continue;\r\n        }\r\n        const newEntry = toInternalFileSystemTree(entry.directory);\r\n        newTree.d[name] = newEntry;\r\n    }\r\n    return newTree;\r\n}\r\n/**\r\n * @internal\r\n */\r\nexport function toExternalFileSystemTree(tree) {\r\n    const newTree = nullPrototype();\r\n    if ('f' in tree) {\r\n        throw new Error('It is not possible to export a single file in the JSON format.');\r\n    }\r\n    if ('d' in tree) {\r\n        for (const name of Object.keys(tree.d)) {\r\n            const entry = tree.d[name];\r\n            if ('d' in entry) {\r\n                newTree[name] = nullPrototype({\r\n                    directory: toExternalFileSystemTree(entry),\r\n                });\r\n            }\r\n            else if ('f' in entry) {\r\n                if ('c' in entry.f) {\r\n                    newTree[name] = nullPrototype({\r\n                        file: nullPrototype({\r\n                            contents: entry.f.b ? fromBinaryString(entry.f.c) : entry.f.c,\r\n                        }),\r\n                    });\r\n                }\r\n                else if ('l' in entry.f) {\r\n                    newTree[name] = nullPrototype({\r\n                        file: nullPrototype({\r\n                            symlink: entry.f.l,\r\n                        }),\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return newTree;\r\n}\r\nfunction fromBinaryString(s) {\r\n    const encoded = new Uint8Array(s.length);\r\n    for (let i = 0; i < s.length; i++) {\r\n        encoded[i] = s[i].charCodeAt(0);\r\n    }\r\n    return encoded;\r\n}\r\n", "/**\r\n * The WebContainer Public API allows you build custom applications on top of an in-browser Node.js runtime.\r\n *\r\n * Its main entrypoint is the {@link WebContainer} class.\r\n *\r\n * @packageDocumentation\r\n */\r\nimport { authState, assertAuthTokens } from './internal/auth-state.js';\r\nimport { PreviewMessageType } from './preview-message-types.js';\r\nimport { Comlink } from './vendor/index.js';\r\nimport { auth as authImpl } from './internal/auth-state.js';\r\nimport { addAccessTokenChangedListener } from './internal/tokens.js';\r\nimport { iframeSettings } from './internal/iframe-url.js';\r\nimport { isPreviewMessage } from './utils.js';\r\nimport { toExternalFileSystemTree, toInternalFileSystemTree } from './utils/file-system.js';\r\nexport const auth = authImpl;\r\nexport { PreviewMessageType };\r\nexport * from './utils.js';\r\nlet bootPromise = null;\r\nlet cachedServerPromise = null;\r\nlet cachedBootOptions = {};\r\nconst decoder = new TextDecoder();\r\nconst encoder = new TextEncoder();\r\n/**\r\n * The main export of this library. An instance of `WebContainer` represents a runtime\r\n * ready to be used.\r\n */\r\nexport class WebContainer {\r\n    _instance;\r\n    _runtimeInfo;\r\n    /**\r\n     * Gives access to the underlying file system.\r\n     */\r\n    fs;\r\n    /** @internal */\r\n    static _instance = null;\r\n    /** @internal */\r\n    static _teardownPromise = null;\r\n    _tornDown = false;\r\n    _unsubscribeFromTokenChangedListener = () => { };\r\n    /** @internal */\r\n    constructor(\r\n    /** @internal */\r\n    _instance, fs, previewScript, \r\n    /** @internal */\r\n    _runtimeInfo) {\r\n        this._instance = _instance;\r\n        this._runtimeInfo = _runtimeInfo;\r\n        this.fs = new FileSystemAPIClient(fs);\r\n        // forward the credentials to webcontainer if needed\r\n        if (authState.initialized) {\r\n            this._unsubscribeFromTokenChangedListener = addAccessTokenChangedListener((accessToken) => {\r\n                this._instance.setCredentials({ accessToken, editorOrigin: authState.editorOrigin });\r\n            });\r\n            (async () => {\r\n                await authState.authComplete.promise;\r\n                if (this._tornDown) {\r\n                    return;\r\n                }\r\n                assertAuthTokens(authState.tokens);\r\n                await this._instance.setCredentials({\r\n                    accessToken: authState.tokens.access,\r\n                    editorOrigin: authState.editorOrigin,\r\n                });\r\n            })().catch((error) => {\r\n                // print the error as this is likely a bug in webcontainer\r\n                console.error(error);\r\n            });\r\n        }\r\n    }\r\n    async spawn(command, optionsOrArgs, options) {\r\n        let args = [];\r\n        if (Array.isArray(optionsOrArgs)) {\r\n            args = optionsOrArgs;\r\n        }\r\n        else {\r\n            options = optionsOrArgs;\r\n        }\r\n        let output = undefined;\r\n        let outputStream = new ReadableStream();\r\n        if (options?.output !== false) {\r\n            const result = streamWithPush();\r\n            output = result.push;\r\n            outputStream = result.stream;\r\n        }\r\n        let stdout = undefined;\r\n        let stdoutStream;\r\n        let stderr = undefined;\r\n        let stderrStream;\r\n        const wrappedOutput = proxyListener(binaryListener(output));\r\n        const wrappedStdout = proxyListener(binaryListener(stdout));\r\n        const wrappedStderr = proxyListener(binaryListener(stderr));\r\n        const process = await this._instance.run({\r\n            command,\r\n            args,\r\n            cwd: options?.cwd,\r\n            env: options?.env,\r\n            terminal: options?.terminal,\r\n        }, wrappedStdout, wrappedStderr, wrappedOutput);\r\n        return new WebContainerProcessImpl(process, outputStream, stdoutStream, stderrStream);\r\n    }\r\n    async export(path, options) {\r\n        const serializeOptions = {\r\n            format: options?.format ?? 'json',\r\n            includes: options?.includes,\r\n            excludes: options?.excludes,\r\n            external: true,\r\n        };\r\n        const result = await this._instance.serialize(path, serializeOptions);\r\n        if (serializeOptions.format === 'json') {\r\n            const data = JSON.parse(decoder.decode(result));\r\n            return toExternalFileSystemTree(data);\r\n        }\r\n        return result;\r\n    }\r\n    on(event, listener) {\r\n        if (event === 'preview-message') {\r\n            const originalListener = listener;\r\n            listener = ((message) => {\r\n                if (isPreviewMessage(message)) {\r\n                    originalListener(message);\r\n                }\r\n            });\r\n        }\r\n        const { listener: wrapped, subscribe } = syncSubscription(listener);\r\n        return subscribe(this._instance.on(event, Comlink.proxy(wrapped)));\r\n    }\r\n    /**\r\n     * Mounts a tree of files into the filesystem. This can be specified as a tree object ({@link FileSystemTree})\r\n     * or as a binary snapshot generated by [`@webcontainer/snapshot`](https://www.npmjs.com/package/@webcontainer/snapshot).\r\n     *\r\n     * @param snapshotOrTree - A tree of files, or a binary snapshot. Note that binary payloads will be transferred.\r\n     * @param options.mountPoint - Specifies a nested path where the tree should be mounted.\r\n     */\r\n    mount(snapshotOrTree, options) {\r\n        const payload = snapshotOrTree instanceof Uint8Array\r\n            ? snapshotOrTree\r\n            : snapshotOrTree instanceof ArrayBuffer\r\n                ? new Uint8Array(snapshotOrTree)\r\n                : encoder.encode(JSON.stringify(toInternalFileSystemTree(snapshotOrTree)));\r\n        return this._instance.loadFiles(Comlink.transfer(payload, [payload.buffer]), {\r\n            mountPoints: options?.mountPoint,\r\n        });\r\n    }\r\n    /**\r\n     * Set a custom script to be injected into all previews. When this function is called, every\r\n     * future page reload will contain the provided script tag on all HTML responses.\r\n     *\r\n     * Note:\r\n     *\r\n     * When this function resolves, every preview reloaded _after_ will have the new script.\r\n     * Existing preview have to be explicitely reloaded.\r\n     *\r\n     * To reload a preview you can use `reloadPreview`.\r\n     *\r\n     * @param scriptSrc Source for the script tag.\r\n     * @param options Options to define which type of script this is.\r\n     */\r\n    setPreviewScript(scriptSrc, options) {\r\n        return this._instance.setPreviewScript(scriptSrc, options);\r\n    }\r\n    /**\r\n     * The default value of the `PATH` environment variable for processes started through {@link spawn}.\r\n     */\r\n    get path() {\r\n        return this._runtimeInfo.path;\r\n    }\r\n    /**\r\n     * The full path to the working directory (see {@link FileSystemAPI}).\r\n     */\r\n    get workdir() {\r\n        return this._runtimeInfo.cwd;\r\n    }\r\n    /**\r\n     * Destroys the WebContainer instance, turning it unusable, and releases its resources. After this,\r\n     * a new WebContainer instance can be obtained by calling {@link WebContainer.boot | `boot`}.\r\n     *\r\n     * All entities derived from this instance (e.g. processes, the file system, etc.) also become unusable\r\n     * after calling this method.\r\n     */\r\n    teardown() {\r\n        if (this._tornDown) {\r\n            throw new Error('WebContainer already torn down');\r\n        }\r\n        this._tornDown = true;\r\n        this._unsubscribeFromTokenChangedListener();\r\n        const teardownFn = async () => {\r\n            try {\r\n                await this.fs._teardown();\r\n                await this._instance.teardown();\r\n            }\r\n            finally {\r\n                this._instance[Comlink.releaseProxy]();\r\n                if (WebContainer._instance === this) {\r\n                    WebContainer._instance = null;\r\n                }\r\n            }\r\n        };\r\n        WebContainer._teardownPromise = teardownFn();\r\n    }\r\n    /**\r\n     * Boots a WebContainer. Only a single instance of WebContainer can be booted concurrently\r\n     * (see {@link WebContainer.teardown | `teardown`}).\r\n     *\r\n     * Booting WebContainer is an expensive operation.\r\n     */\r\n    static async boot(options = {}) {\r\n        await this._teardownPromise;\r\n        WebContainer._teardownPromise = null;\r\n        const { workdirName } = options;\r\n        if (window.crossOriginIsolated && options.coep === 'none') {\r\n            console.warn(`A Cross-Origin-Embedder-Policy header is required in cross origin isolated environments.\\nSet the 'coep' option to 'require-corp'.`);\r\n        }\r\n        if (workdirName?.includes('/') || workdirName === '..' || workdirName === '.') {\r\n            throw new Error('workdirName should be a valid folder name');\r\n        }\r\n        // signal that boot was called to auth module as calling auth.init after boot is likely incorrect\r\n        authState.bootCalled = true;\r\n        // try to \"acquire the lock\", i.e. wait for any ongoing boot request to finish\r\n        while (bootPromise) {\r\n            await bootPromise;\r\n        }\r\n        if (WebContainer._instance) {\r\n            throw new Error('Only a single WebContainer instance can be booted');\r\n        }\r\n        const instancePromise = unsynchronizedBoot(options);\r\n        // the \"lock\" is a promise for the ongoing boot that never fails\r\n        bootPromise = instancePromise.catch(() => { });\r\n        try {\r\n            const instance = await instancePromise;\r\n            WebContainer._instance = instance;\r\n            return instance;\r\n        }\r\n        finally {\r\n            // release the \"lock\"\r\n            bootPromise = null;\r\n        }\r\n    }\r\n}\r\n/**\r\n * Configure an API key to be used for this instance of WebContainer.\r\n *\r\n * @param key WebContainer API key.\r\n */\r\nexport function configureAPIKey(key) {\r\n    if (authState.bootCalled) {\r\n        throw new Error('`configureAPIKey` should always be called before `WebContainer.boot`');\r\n    }\r\n    iframeSettings.setQueryParam('client_id', key);\r\n}\r\nconst DIR_ENTRY_TYPE_FILE = 1;\r\nconst DIR_ENTRY_TYPE_DIR = 2;\r\n/**\r\n * @internal\r\n */\r\nclass DirEntImpl {\r\n    name;\r\n    _type;\r\n    constructor(name, _type) {\r\n        this.name = name;\r\n        this._type = _type;\r\n    }\r\n    isFile() {\r\n        return this._type === DIR_ENTRY_TYPE_FILE;\r\n    }\r\n    isDirectory() {\r\n        return this._type === DIR_ENTRY_TYPE_DIR;\r\n    }\r\n}\r\nclass FSWatcher {\r\n    _apiClient;\r\n    _path;\r\n    _options;\r\n    _listener;\r\n    _wrappedListener;\r\n    _watcher;\r\n    _closed = false;\r\n    constructor(_apiClient, _path, _options, _listener) {\r\n        this._apiClient = _apiClient;\r\n        this._path = _path;\r\n        this._options = _options;\r\n        this._listener = _listener;\r\n        this._apiClient._watchers.add(this);\r\n        this._wrappedListener = (event, filename) => {\r\n            if (this._listener && !this._closed) {\r\n                this._listener(event, filename);\r\n            }\r\n        };\r\n        this._apiClient._fs\r\n            .watch(this._path, this._options, proxyListener(this._wrappedListener))\r\n            .then((_watcher) => {\r\n            this._watcher = _watcher;\r\n            if (this._closed) {\r\n                return this._teardown();\r\n            }\r\n            return undefined;\r\n        })\r\n            .catch(console.error);\r\n    }\r\n    async close() {\r\n        if (!this._closed) {\r\n            this._closed = true;\r\n            this._apiClient._watchers.delete(this);\r\n            await this._teardown();\r\n        }\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    async _teardown() {\r\n        await this._watcher?.close().finally(() => {\r\n            this._watcher?.[Comlink.releaseProxy]();\r\n        });\r\n    }\r\n}\r\n/**\r\n * @internal\r\n */\r\nclass WebContainerProcessImpl {\r\n    output;\r\n    input;\r\n    exit;\r\n    _process;\r\n    stdout;\r\n    stderr;\r\n    constructor(process, output, stdout, stderr) {\r\n        this.output = output;\r\n        this._process = process;\r\n        this.input = new WritableStream({\r\n            write: (data) => {\r\n                // this promise is not supposed to fail anyway\r\n                this._getProcess()\r\n                    ?.write(data)\r\n                    .catch(() => { });\r\n            },\r\n        });\r\n        this.exit = this._onExit();\r\n        this.stdout = stdout;\r\n        this.stderr = stderr;\r\n    }\r\n    kill() {\r\n        this._process?.kill();\r\n    }\r\n    resize(dimensions) {\r\n        this._getProcess()?.resize(dimensions);\r\n    }\r\n    async _onExit() {\r\n        try {\r\n            return await this._process.onExit;\r\n        }\r\n        finally {\r\n            this._process?.[Comlink.releaseProxy]();\r\n            this._process = null;\r\n        }\r\n    }\r\n    _getProcess() {\r\n        if (this._process == null) {\r\n            console.warn('This process already exited');\r\n        }\r\n        return this._process;\r\n    }\r\n}\r\n/**\r\n * @internal\r\n */\r\nclass FileSystemAPIClient {\r\n    _fs;\r\n    _watchers = new Set([]);\r\n    constructor(fs) {\r\n        this._fs = fs;\r\n    }\r\n    rm(...args) {\r\n        return this._fs.rm(...args);\r\n    }\r\n    async readFile(path, encoding) {\r\n        return await this._fs.readFile(path, encoding);\r\n    }\r\n    async rename(oldPath, newPath) {\r\n        return await this._fs.rename(oldPath, newPath);\r\n    }\r\n    async writeFile(path, data, options) {\r\n        if (data instanceof Uint8Array) {\r\n            const buffer = data.buffer.slice(data.byteOffset, data.byteOffset + data.byteLength);\r\n            data = Comlink.transfer(new Uint8Array(buffer), [buffer]);\r\n        }\r\n        await this._fs.writeFile(path, data, options);\r\n    }\r\n    async readdir(path, options) {\r\n        const result = await this._fs.readdir(path, options);\r\n        if (isStringArray(result)) {\r\n            return result;\r\n        }\r\n        if (isTypedArrayCollection(result)) {\r\n            return result;\r\n        }\r\n        const entries = result.map((entry) => new DirEntImpl(entry.name, entry['Symbol(type)']));\r\n        return entries;\r\n    }\r\n    async mkdir(path, options) {\r\n        return await this._fs.mkdir(path, options);\r\n    }\r\n    watch(path, options, listener) {\r\n        if (typeof options === 'function') {\r\n            listener = options;\r\n            options = null;\r\n        }\r\n        return new FSWatcher(this, path, options, listener);\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    async _teardown() {\r\n        this._fs[Comlink.releaseProxy]();\r\n        await Promise.all([...this._watchers].map((watcher) => watcher.close()));\r\n    }\r\n}\r\nasync function unsynchronizedBoot(options) {\r\n    const { serverPromise } = serverFactory(options);\r\n    const server = await serverPromise;\r\n    const instance = await server.build({\r\n        host: window.location.host,\r\n        version: \"1.6.1\",\r\n        workdirName: options.workdirName,\r\n        forwardPreviewErrors: options.forwardPreviewErrors,\r\n    });\r\n    const [fs, previewScript, runtimeInfo] = await Promise.all([\r\n        instance.fs(),\r\n        instance.previewScript(),\r\n        instance.runtimeInfo(),\r\n    ]);\r\n    return new WebContainer(instance, fs, previewScript, runtimeInfo);\r\n}\r\nfunction binaryListener(listener) {\r\n    if (listener == null) {\r\n        return undefined;\r\n    }\r\n    return (data) => {\r\n        if (data instanceof Uint8Array) {\r\n            listener(decoder.decode(data));\r\n        }\r\n        else if (data == null) {\r\n            listener(null);\r\n        }\r\n    };\r\n}\r\nfunction proxyListener(listener) {\r\n    if (listener == null) {\r\n        return undefined;\r\n    }\r\n    return Comlink.proxy(listener);\r\n}\r\nfunction serverFactory(options) {\r\n    if (cachedServerPromise != null) {\r\n        if (options.coep !== cachedBootOptions.coep) {\r\n            console.warn(`Attempting to boot WebContainer with 'coep: ${options.coep}'`);\r\n            console.warn(`First boot had 'coep: ${cachedBootOptions.coep}', new settings will not take effect!`);\r\n        }\r\n        return { serverPromise: cachedServerPromise };\r\n    }\r\n    if (options.coep) {\r\n        iframeSettings.setQueryParam('coep', options.coep);\r\n    }\r\n    if (options.experimentalNode) {\r\n        iframeSettings.setQueryParam('experimental_node', '1');\r\n    }\r\n    const iframe = document.createElement('iframe');\r\n    iframe.style.display = 'none';\r\n    iframe.setAttribute('allow', 'cross-origin-isolated');\r\n    const url = iframeSettings.url;\r\n    iframe.src = url.toString();\r\n    const { origin } = url;\r\n    cachedBootOptions = { ...options };\r\n    cachedServerPromise = new Promise((resolve) => {\r\n        const onMessage = (event) => {\r\n            if (event.origin !== origin) {\r\n                return;\r\n            }\r\n            const { data } = event;\r\n            if (data.type === 'init') {\r\n                resolve(Comlink.wrap(event.ports[0]));\r\n                return;\r\n            }\r\n            if (data.type === 'warning') {\r\n                console[data.level].call(console, data.message);\r\n                return;\r\n            }\r\n        };\r\n        window.addEventListener('message', onMessage);\r\n    });\r\n    document.body.insertBefore(iframe, null);\r\n    return { serverPromise: cachedServerPromise };\r\n}\r\nfunction isStringArray(list) {\r\n    return typeof list[0] === 'string';\r\n}\r\nfunction isTypedArrayCollection(list) {\r\n    return list[0] instanceof Uint8Array;\r\n}\r\nfunction streamWithPush() {\r\n    let controller = null;\r\n    const stream = new ReadableStream({\r\n        start(controller_) {\r\n            controller = controller_;\r\n        },\r\n    });\r\n    const push = (item) => {\r\n        if (item != null) {\r\n            controller?.enqueue(item);\r\n        }\r\n        else {\r\n            controller?.close();\r\n            controller = null;\r\n        }\r\n    };\r\n    return { stream, push };\r\n}\r\nfunction syncSubscription(listener) {\r\n    let stopped = false;\r\n    let unsubscribe = () => { };\r\n    const wrapped = ((...args) => {\r\n        if (stopped) {\r\n            return;\r\n        }\r\n        listener(...args);\r\n    });\r\n    return {\r\n        subscribe(promise) {\r\n            promise.then((unsubscribe_) => {\r\n                unsubscribe = unsubscribe_;\r\n                if (stopped) {\r\n                    unsubscribe();\r\n                }\r\n            });\r\n            return () => {\r\n                stopped = true;\r\n                unsubscribe();\r\n            };\r\n        },\r\n        listener: wrapped,\r\n    };\r\n}\r\n"],
  "mappings": "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",
  "names": ["editorOrigin", "editorOrigin", "PreviewMessageType", "auth", "_a"]
}
